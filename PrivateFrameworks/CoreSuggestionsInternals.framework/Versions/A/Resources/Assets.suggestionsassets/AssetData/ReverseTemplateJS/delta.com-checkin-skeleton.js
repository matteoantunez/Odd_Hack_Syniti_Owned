(function(){return function(e,t,r){var a,i,n,p,o,g,s,m,l,d,u,h,T,v,c=Scanner.fromMessage(e);c.setLocale(t);var C=[];a=c.getSpan().next(r.name).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,r.name),1),p=(n=c.getSpan().next(r.reservationId).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)</,r.reservationId),1)).nextAnyTag("td").innerLink(),T=c.getSpan().next(r.departure).parentTag("table5").allInnerTags("tr5");var x=!1;for(u=1;u<T.length;u++)if(T[u].tagContents().innerRegExp(r.departure).exists())d=T[u].tagContents().innerRegExp(r.departure).previousAnyTag("th").tagContents();else if(/Trip \w{3,}/.test(T[u].toString()))x=!1;else if(T[u].innerDate().exists()){h={},v=T[u].nextTag("td6").tagContents().innerCapture(/($<airline>[^\d]+)\s+($<flightNumber>\d+)/),h.airlineName=v.$airline,h.flightNumber=v.$flightNumber,h.airlineCode=/delta/gi.test(h.airlineName)?"DL":null,h.departureAirport=h.flightNumber.nextTag("td6").nextTag("td6").tagContents(),h.departureTime=c.getDetachedSpan(d.toString()+" "+h.departureAirport.nextTag("td6").tagContents().toString()).lastInnerDate(),x&&(h.departureTime=modifyDate(h.departureTime,1)),h.arrivalAirport=h.departureAirport.nextTag("td6").nextTag("td6").tagContents(),i=h.arrivalAirport.nextTag("td6").tagContents().toString().replace("N"," pm"),h.seatNumber=h.arrivalAirport.nextTag("td6").nextTag("td6").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,r.seat),1);var N=!1;/\*\*/.test(i)?(i=i.replace("**","").replace(/\n/,""),x=!0,N=!0):/ on \w{3,}/.test(i)?(i=i.replace(/ on/i,""),x=!0,N=!0):i=d+" "+i.toString(),h.arrivalTime=c.getDetachedSpan(i).lastInnerDate(),x&&!N&&(h.arrivalTime=modifyDate(h.arrivalTime,1)),ASSERT(h.airlineName,h.flightNumber,h.departureAirport,h.departureTime,h.arrivalAirport,h.arrivalTime)&&C.push(h)}var f=[];for(u=0;u<C.length;u++){var A={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:(h=C[u]).airlineName,airlineCode:h.airlineCode,flightNumber:h.flightNumber,departureAirportFuzzy:h.departureAirport,departureAirportCode:h.departureCode,departureTime:h.departureTime,arrivalAirportFuzzy:h.arrivalAirport,arrivalAirportCode:h.arrivalCode,arrivalTime:h.arrivalTime},underName:{"@type":"http://schema.org/Person",name:a},checkinUrl:p,reservationId:n.toString().trim(),reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:g,priceCurrency:s,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:o,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:h.seatNumber,seatingType:h.seatingType}}};valid(m,l)&&(A.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:m,programName:l}),f.push(A)}if(f.length)return f}}).call();