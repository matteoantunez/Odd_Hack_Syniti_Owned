(function(){return function(e,r,t){var n,a,i,l,g,o,p,s,m,h,u,d,c=Scanner.fromMessage(e);c.setLocale(r);var T=[],v=[],f=[];n=c.getSpan().innerCapture(regExpFormatted(/\1\s+(\w+)/,t.reservationId),1),l=c.getSpan().next(t.checkIn).nextLink();for(var S,C=c.getSpan().next(t.passenger);0!==C.toString().length;)S=C.innerCapture(t.passenger),(p={}).name=S.$name,p.ticketNumber=S.$ticketNumber,ASSERT(p.name)&&T.push(p),C=C.next(t.passenger);if(0===T.length)for(C=c.getSpan().next(t.reservationId).next(t.passenger_alt);0!==C.toString().length;)S=C.innerCapture(t.passenger_alt),(p={}).name=S.$name.trim(),ASSERT(p.name)&&T.push(p),C=C.nextDate().next(t.passenger_alt);for(m=0!==(m=c.getSpan().next(t.flightDetails).nextAnyTag("table")).allInnerTags("tr3").length?m.allInnerTags("tr3"):m.allInnerTags("tr4"),g=0;g<m.length;g++)s={},0===(o=m[g].allInnerTags("td3")).toString().length&&(o=m[g].allInnerTags("td4")),o.length>2&&((h=o[0].allInnerDates()).length>1?(a=h[0],i=h[1]):a=i=h[0],s.departureTime=combineDateAndTime(a,o[1].innerDate()),s.departureAirport=o[1].tagContents().innerCapture(/(.*)\n/,1),s.arrivalTime=combineDateAndTime(i,o[2].innerDate()),s.arrivalAirport=o[2].tagContents().innerCapture(/(.*)\n/,1),u=o[3].innerCapture(/($<airlineCode>\w+)\s($<flightNumber>\d+)/),s.airlineCode=u.$airlineCode,s.flightNumber=u.$flightNumber,s.seatingType=o[4].tagContents().innerCapture(/\n(.*)/,1),ASSERT(s.departureAirport,s.arrivalAirport,s.departureTime,s.arrivalTime,s.airlineCode,s.flightNumber)&&v.push(s));d=t.bookingPending?"Pending":"Confirmed";for(var A=0;A<T.length;A++)for(p=T[A],g=0;g<v.length;g++){f.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Aero M\xe9xico",airlineCode:(s=v[g]).airlineCode,flightNumber:s.flightNumber,departureAirportFuzzy:s.departureAirport,departureTime:s.departureTime,arrivalAirportFuzzy:s.arrivalAirport,arrivalTime:s.arrivalTime},underName:{"@type":"http://schema.org/Person",name:p.name},checkinUrl:l,reservationId:n,reservationStatus:"http://schema.org/Reservation"+d,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:p.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat"}}})}if(f.length)return f}}).call();