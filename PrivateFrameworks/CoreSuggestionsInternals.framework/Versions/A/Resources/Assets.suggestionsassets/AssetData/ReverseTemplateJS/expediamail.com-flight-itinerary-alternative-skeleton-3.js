(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,l,d,p,o,u,g,m,s,c=a.getSpan(),A=[],T=[],$=c.next(r.dates).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<firstDate>.*)\s-\s($<secondDate>.*)/,r.dates)),h=$?$.$firstDate:null;c.next(r.itNum).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+(.*)/,r.itNum),1);i=r.cancelled.test(e.plain)?"cancelled":"confirmed",n=($=c.next(r.confirmation).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<confirm>.*)\s*\(($<airlineName>.*)\)/,r.confirmation)))?$.$confirm:null,l=$?$.airlineName:null;var C=c.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$1")}),f=c.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$2")});$=a.getSpan().next(r.departure).parentAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/[a-zA-Z ]+($<flightNumber>\d+)\s(?:\1.*)?/);for(var v=1;v<C.length;v++)A.push({name:f[v],ticketNumber:C[v]});var b=c.next(r.dep).parentAnyTag("table"),x=c.next(r.ari).parentAnyTag("table"),y=function(e,t){for(var n=e.allInnerTagsFiltered("table8"),i=a.getDetachedSpan(c.next(t).parentAnyTag("table").innerDate().toString()),l=!1,A=0;A<n.length;A+=2){var $=c.next(t).parentAnyTag("table").allInnerTagsFiltered("table8")[A].innerCapture(/($<dep>[a-zA-Z ]+)\s\(($<depCode>\w+)\)\s[\n]+\s*\[.*\]\s($<time>\d?\d:\d\d(?:am|pm)?)($<day>\s\+\d\s\w+)?/i);o=$?$.$dep:null,p=$?$.$time:null,u=$?$.$depCode:null,p=combineDateAndTime(i,p);var h=c.next(t).parentAnyTag("table").allInnerTagsFiltered("table8")[A+1].innerCapture(/($<dep>[a-zA-Z ]+)\s\(($<depCode>\w+)\)\s[\n]+\s*\[.*\]\s($<time>\d?\d:\d\d(?:am|pm)?)($<day>\s\+\d\s\w+)?/i);m=h?h.$dep:null,g=h?h.$time:null,s=h?h.$depCode:null,(h?h.$day:null).isNullSpan_?g=combineDateAndTime(i,g):(i=modifyDate(i,1),g=combineDateAndTime(i,g)),A>1&&(l=!0);var C=(l?c.next(o).next(o).next(o):c.next(o)).parentAnyTag("td").previousTag("td6").tagContents().innerCapture(regExpFormatted(/[a-zA-Z ]+($<flightNumber>\d+)\s?(?:\1.*)?/,r.op));d=C?C.$flightNumber:null,ASSERT(o,p,m,g)&&T.push({departureAirport:o,departureCode:u,departureTime:p,arrivalTime:g,arrivalAirport:m,flightNumber:d,arrivalCode:s})}};if(y(b,r.dep),y(x,r.ari),0===T.length)for(var N=c.next(r.departure).nextTag("table7"),S=c.next(r.departure).nextTag("table7").allInnerTagsFiltered("td8");!N.isNullSpan_&&0!==S.length;){$=S[0].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/),o=$?$.$airlineName:null,u=$?$.$airlineCode:null,p=S[1];var F=N.previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/[a-zA-Z ]+($<flightNumber>\d+)\s?(?:\1.*)?/,r.op));d=F?F.$flightNumber:null,p=combineDateAndTime(a.getDetachedSpan(h.toString()),p),$=S[2].innerCapture(/($<airlineName>[a-zA-Z]+)\s\(($<airlineCode>[\d\w]+)\)/),m=$?$.$airlineName:null,s=$?$.$airlineCode:null,/\d?\d:\d{2}(?:AM|PM)?/i.test(g=S[3])||(g=S[4]),g=combineDateAndTime(a.getDetachedSpan(h.toString()),g),ASSERT(o,p,m,g)&&T.push({departureAirport:o,departureCode:u,departureTime:p,arrivalTime:g,arrivalAirport:m,flightNumber:d,arrivalCode:s}),S=(N=N.nextTag("table7")).allInnerTagsFiltered("td8")}for(var z=[],D=0;D<T.length;D++)for(var E=T[D],Z=0;Z<A.length;Z++){z.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:l,flightNumber:E.flightNumber,departureAirportFuzzy:E.departureAirport,departureAirportCode:E.departureCode,departureTime:E.departureTime,arrivalAirportFuzzy:E.arrivalAirport,arrivalAirportCode:E.arrivalCode,arrivalTime:E.arrivalTime},underName:{"@type":"http://schema.org/Person",name:A[Z].name},reservationId:n,ticketNumber:A[Z].ticketNumber,reservationStatus:"http://schema.org/Reservation"+i})}return z}}).call();