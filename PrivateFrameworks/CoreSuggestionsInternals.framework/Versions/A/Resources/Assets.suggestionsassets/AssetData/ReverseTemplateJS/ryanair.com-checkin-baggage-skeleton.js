(function(){return function(e,r,t){function a(e){if(e){var t=(l=p.getSpan().nextRegExp(regExpFormatted(/\1/,e)).parentAnyTag("td")).getTagNumber()-2;"it_IT"===r&&(t-=1),4===(l=l.parentTag("table"+t).allInnerTags("tr"+t)).length&&5===(g=l[2].allInnerTagsFiltered("td"+t)).length&&(u=g[0].innerCapture(/^($<departureAirport>.*?) - ($<arrivalAirport>.*?)$/),v=u?u.$departureAirport:null,b=u?u.$arrivalAirport:null,(m=g[1].innerDate()).exists()||(m=p.getDetachedSpan(g[1].tagContents().toString().replace(/(\d+)([A-Za-z]+)(\d+)/,"$1 $2 $3"))),d=g[2].innerCapture(/($<code>[A-Z]+)($<flightNumber>\d+)/),h=d?d.$code:null,s=d?d.$flightNumber:null,c=combineDateAndTime(m,g[3].innerDate()),T=combineDateAndTime(m,g[4].innerDate()),ASSERT(h,s,c,T)&&N.push({airlineCode:h,flightNumber:s,departureAirport:v,departureTime:c,arrivalAirport:b,arrivalTime:T,passengers:A}))}}if(!regExpFormatted(/\1/,t.reservationId).test(e.plain))return CONTINUE;var i,n,o,p=Scanner.fromMessage(e);p.setLocale(r);var m,g,l,s,u,d,h,c,v,T,b,N=[],A={};n=p.getSpan().nextText(t.reservationId).nextTag("td9").tagContents(),A[e.to]={name:e.to,seats:{},seatingType:{}},a(t.goingOut),a(t.comingBack);for(var f=[],y=0;y<N.length;y++)for(var C=N[y],S=Object.keys(C.passengers),$=0;$<S.length;$++){var x=C.passengers[S[$]],F={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:C.airlineName,airlineCode:C.airlineCode,flightNumber:C.flightNumber,departureAirportFuzzy:C.departureAirport,departureAirportCode:C.departureCode,departureTime:C.departureTime,arrivalAirportFuzzy:C.arrivalAirport,arrivalAirportCode:C.arrivalCode,arrivalTime:C.arrivalTime},underName:{"@type":"http://schema.org/Person",name:x.name},checkinUrl:o,reservationId:n,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:x.totalPrice,priceCurrency:x.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:x.seats[C.airlineCode.toString()+C.flightNumber.toString()],seatingType:x.seatingType[C.flightNumber]}}};valid(x.membershipNumber,x.programName)&&(F.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:x.membershipNumber,programName:x.programName}),f.push(F)}return f.length?f:void 0}}).call();