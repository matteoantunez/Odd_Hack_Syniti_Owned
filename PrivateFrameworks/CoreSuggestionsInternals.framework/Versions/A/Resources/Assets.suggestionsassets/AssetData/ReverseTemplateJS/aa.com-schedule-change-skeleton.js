(function(){return function(e,r,t){function a(){y||ASSERT(g,l,c,h,d,C)&&(u="American"===g.toString()?"AA":null,b.push({airlineName:g,airlineCode:u,flightNumber:l,departureAirport:c,departureTime:h,arrivalAirport:d,arrivalTime:C,passengers:T}),g=u=l=c=h=d=C=null,T={}),y=!1}if(!e||!r||!t)return CONTINUE;var n,i,o,p=Scanner.fromMessage(e);p.setLocale(r);var s,m,g,u,l,c,h,d,C,v,b=[],T={};n=p.getSpan().nextText(t.reservationIdPrefix).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\b\1: (.*)/,t.reservationIdPrefix),1);var N=p.getSpan().nextTag("table5").allInnerTags("td5"),y=!0;for(o=0;o<N.length;o++)N[o].innerCapture(t.dateRegex)&&N[o+1]?(a(),m=N[o+1].innerDate()):N[o].innerCapture(t.flightRegex)&&N[o+2]?(g=N[o+1].tagContents(),l=N[o+2].tagContents()):N[o].innerCapture(t.departureRegex)&&N[o+2]?(c=N[o+1].tagContents(),h=combineDateAndTime(m,N[o+2].innerDate())):N[o].innerCapture(t.arrivalRegex)&&N[o+2]?(d=N[o+1].tagContents(),C=combineDateAndTime(m,N[o+2].innerDate())):N[o].innerCapture(t.seatRegex)&&N[o+1]?(s=N[o-1].tagContents().toString(),v=N[o+2].tagContents()&&N[o+2].tagContents().innerCapture(/^FF#:\s+($<number>[\w\-]+)/,1),T[s]={name:s,seat:N[o].tagContents().innerCapture(concatRegExp(t.seatRegex,/\s+(.*)/),1),seatingType:N[o+1].tagContents(),programName:"Frequent Flyer",membershipNumber:v}):N[o].innerCapture(t.nameRegex)&&N[o+2]&&(s=N[o+1].tagContents(),T[s]||(T[s]={name:s,seatingType:N[o+3].tagContents()}));a();var f=[];for(o=0;o<b.length;o++)for(var x=b[o],A=Object.keys(x.passengers),F=0;F<A.length;F++){var R=x.passengers[A[F]],S={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:x.airlineName,airlineCode:x.airlineCode,flightNumber:x.flightNumber,departureAirportFuzzy:x.departureAirport,departureAirportCode:x.departureCode,departureTime:x.departureTime,arrivalAirportFuzzy:x.arrivalAirport,arrivalAirportCode:x.arrivalCode,arrivalTime:x.arrivalTime},underName:{"@type":"http://schema.org/Person",name:R.name},checkinUrl:i,reservationId:n,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:R.totalPrice,priceCurrency:R.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:R.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:R.seatingType,seatNumber:R.seat}}};valid(R.membershipNumber)&&(S.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:R.membershipNumber,programName:R.programName}),f.push(S)}return f.length?f:void 0}}).call();