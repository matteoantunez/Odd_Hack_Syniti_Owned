(function(){return function(e,r,t){var a,i,n,p=Scanner.fromMessage(e);p.setLocale(r);var m,o,l,g,u,s,h,d,c,v,S,N,x=[],y={};i=(g=p.getSpan()).next(t.reservationId).innerCapture(t.reservationId,1);do{if(S?S=S.next(t.name):0===(S=g.next(t.name)).toString().length&&(S=g.next(t.name_alt)),0===(m=S.innerCapture(t.name,1)).toString().length&&(m=S.innerCapture(t.name_alt,1).trim()),a=S.innerCapture(t.ticket,1).trim(),not(m))return CONTINUE;y[m.toString()]={name:m,seats:{},seatingType:{},ticketNumber:a,totalPrice:null,priceCurrency:null}}while(0!==S.next(t.name).toString().length);do{(N=N?N.next(t.flightSummary):g.next(t.flightSummary)).isNullSpan_||(o=N.innerCapture(t.flightSummary),(h=N.next(t.departure).nextDate()).toString().match(/\-/)&&(h=g.getScanner().getDetachedSpan(N.next(t.departure).nextRegExp(/\d.*/).toString().replace("-"," ")).innerDate()),(c=N.next(t.arrival).nextDate()).toString().match(/\-/)&&(c=g.getScanner().getDetachedSpan(N.next(t.arrival).nextRegExp(/\d.*/).toString().replace("-"," ")).innerDate()),d=N.next(t.departure).innerCapture(t.departure).$airportAddress,v=N.next(t.arrival).innerCapture(t.arrival).$airportAddress,s=o.$airlineCode,u=o.$airlineName,l=o.$flightNumber,ASSERT(s,l,d,h,v,c)&&x.push({reservationId:i,airlineName:u,airlineCode:s,flightNumber:l,departureAirport:d,departureTime:h,arrivalAirport:v,arrivalTime:c,passengers:y}))}while(0!==N.next(t.flightSummary).toString().length);for(var C=[],b=0;b<x.length;b++)for(var f=x[b],T=Object.keys(f.passengers),A=0;A<T.length;A++){var k=f.passengers[T[A]],z={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:f.airlineName,airlineCode:f.airlineCode,flightNumber:f.flightNumber,departureAirportFuzzy:f.departureAirport,departureAirportCode:f.departureCode,departureTime:f.departureTime,arrivalAirportFuzzy:f.arrivalAirport,arrivalAirportCode:f.arrivalCode,arrivalTime:f.arrivalTime},underName:{"@type":"http://schema.org/Person",name:k.name},checkinUrl:n,reservationId:f.reservationId,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:null,priceCurrency:null,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:a,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:k.seats[f.flightNumber],seatingType:k.seatingType[f.flightNumber]}}};valid(k.membershipNumber,k.programName)&&(z.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:k.membershipNumber,programName:k.programName}),C.push(z)}if(C.length)return C}}).call();