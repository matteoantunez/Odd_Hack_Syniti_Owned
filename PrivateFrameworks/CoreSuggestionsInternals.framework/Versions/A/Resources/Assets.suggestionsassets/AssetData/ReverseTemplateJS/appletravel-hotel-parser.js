(function(){return function(e,t){var n=Scanner.fromMessage(e);n.setLocale("en_US");var r=n.getSpan(),a=[],o=[],i=[],c=e.plain.split(/Check In/i).length-1;e.plain.slice();r=r.next(/Trip Overview/);for(var s=0;s<c;s++)r=r.next(/(^Hotel[\s\S]*?)(?:^Flight [A-Z]|^Hotel$|^Car Rental$|^Plan)/gm),i.push(r.toString());return i.forEach(function(e){var r,a,i,c,s,h,l,m,u,d,p,g,v,k,f,T,S=n.getDetachedSpan(e),D=e.slice();e=e.split("\n");(c=/Confirmation #.*\n.*\n(.*)\n/.exec(D))&&2===c.length&&(c=c[1]),p=(m=S.next(/Check in/i).nextDate()).nextDate(),v=e[4],""===(f=S.nextAddress()).toString()&&(f=e[6].split("<")[0]),k=e[8],(r=/Rate.*\n.*\n([\d,.]+)\s*([A-Z]{2,3})/.exec(D))&&3===r.length&&(a=r[1],i=r[2]),o.push({totalPrice:a,priceCurrency:i,reservationId:c,reservationStatus:s,checkInTime:h,checkInDate:l,checkInDateTime:m,checkOutTime:u,checkOutDate:d,checkOutDateTime:p,hotelUrl:g,hotelName:v,hotelPhone:k,hotelAddress:f,modifyReservationUrl:T,underPersonName:t.underName})}),o.forEach(function(e){ASSERT(e.checkInDateTime,e.checkOutDateTime,e.hotelName,e.hotelAddress),a.push({"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:e.underPersonName},totalPrice:e.totalPrice,priceCurrency:e.priceCurrency,checkinTime:e.checkInDateTime,checkoutTime:e.checkOutDateTime,modifyReservationUrl:e.modifyReservationUrl,reservationStatus:"http://schema.org/Reservation"+(e.reservationStatus||"Confirmed"),reservationId:e.reservationId,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:e.hotelName,url:e.hotelUrl,telephone:e.hotelPhone,address:e.hotelAddress}})}),a.length>=1?a:CONTINUE}}).call();