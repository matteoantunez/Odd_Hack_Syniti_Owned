(function(){return function(e,r,t){var a,n,i,o,p,s,g,m,d,c,l,h,u,T,v,y,C,f,A,S,k,x,N=Scanner.fromMessage(e);N.setLocale(r);var b=[],I=[],R=[],$=[],F=[];for(x=N.getSpan().next(t.contactPerson).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.contactPerson),1),d=N.getSpan().next(t.passengers).parentAnyTag("table").allInnerTags("tr4"),a=1;a<d.length;a++)d[a].allInnerTags("td4").length>2&&((c={}).name=d[a].nextAnyTag("td").tagContents(),R.push(c));for(C=(y=N.getSpan().next(t.price).nextAnyTag("td").tagContents()).innerCapture(/([\d,.]+)/,1),f=y.innerCapture(/([^\d,.]+)/,1),i=N.getSpan().next(t.flightSummary).nextAnyTag("table").allInnerCapture(t.departure,0),a=0;a<i.length;a++)T={},p=(o=i[a]).previousAnyTag("td").previousAnyTag("td").tagContents().toString().replace(/-/g," "),s=o.parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<departureAirport>.*)\s+\(($<departureCode>.*)\)\s+\1\s+($<departureTime>.*)/,t.departure)),T.departureAirport=s.$departureAirport,T.departureCode=s.$departureCode,T.departureTime=N.getDetachedSpan(p.toString()+" "+s.$departureTime.toString()).innerDate(),g=o.next(t.arrival).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<arrivalAirport>.*)\s+\(($<arrivalCode>.*)\)\s+\1\s+($<arrivalTime>.*)/,t.arrival)),T.arrivalAirport=g.$arrivalAirport,T.arrivalCode=g.$arrivalCode,T.arrivalTime=N.getDetachedSpan(p.toString()+" "+g.$arrivalTime.toString()).innerDate(),m=o.next(t.flight).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<airline>.*)\s+\1\s+($<flightNr>\d+)/,t.flight)),T.airlineName=m.$airline,T.flightNumber=m.$flightNr,T.seatingType=m.$flightNr.nextAnyTag("td").nextAnyTag("td").tagContents(),T.reservationId=N.getSpan().next(t.flightReservationId).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.flightReservationId),1),ASSERT(T.airlineName,T.flightNumber,T.arrivalTime,T.departureTime,T.arrivalAirport,T.departureAirport)&&I.push(T);for(l=N.getSpan().next(t.carSummary).parentTag("table3").allInnerCapture(t.carPickup,0),a=0;a<l.length;a++)(h={}).pickupTime=(u=l[a]).parentAnyTag("td").tagContents().innerDate(),h.dropoffTime=u.next(t.carDropoff).parentAnyTag("td").tagContents().innerDate(),h.pickupAddress=h.dropoffAddress=u.next(t.carLocation).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.carLocation),1),h.reservationId=u.next(t.carReservationId).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.carReservationId),1),h.provider=u.parentTag("td4").tagContents().innerCapture(/(.*)\:/,1),h.name=x,ASSERT(h.name,h.provider,h.dropoffTime,h.pickupTime)&&$.push(h);for(A=N.getSpan().next(t.hotelSummary).parentTag("table3").allInnerCapture(t.checkIn,0),a=0;a<A.length;a++)S={},k=(v=A[a]).parentAnyTag("td").innerCapture(regExpFormatted(/\1:\s+($<checkIn>.*)[\s\S]*\2:\s+($<checkOut>.*)/,t.checkIn,t.checkOut)),S.checkInDateTime=k.$checkIn.innerDate(),S.checkOutDateTime=k.$checkOut.innerDate(),S.address=v.parentAnyTag("table").innerAddress(),S.hotelName=v.parentAnyTag("table").nextAnyTag("td").tagContents(),S.phone=v.next(t.hotelPhone).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+([\d\s\(\)-]*)\s+/,t.hotelPhonePrefix),1).toString().trim(),S.name=v.parentAnyTag("table").parentAnyTag("table").parentAnyTag("table").inner(t.hotelUnderName).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.hotelUnderName),1).toString().trim(),ASSERT(S.hotelName,S.name,S.checkInDateTime)&&F.push(S);for(a=0;a<I.length;a++){T=I[a];for(var U=0;U<R.length;U++){var P=R[U];n={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:T.airlineName,airlineCode:T.airlineCode,flightNumber:T.flightNumber,departureAirportFuzzy:T.departureAirport,departureAirportCode:T.departureCode,departureTime:T.departureTime,arrivalAirportFuzzy:T.arrivalAirport,arrivalAirportCode:T.arrivalCode,arrivalTime:T.arrivalTime},underName:{"@type":"http://schema.org/Person",name:P.name},checkinUrl:T.checkinUrl,reservationId:T.reservationId,reservationStatus:"http://schema.org/Reservation"+(T.reservationStatus||"Confirmed"),totalPrice:C,priceCurrency:f,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:P.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:T.seats,seatingType:T.seatingType}}},valid(P.membershipNumber,P.programName)&&(n.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:P.membershipNumber,programName:P.programName}),b.push(n)}}for(a=0;a<$.length;a++)n={"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:C,priceCurrency:f,reservationId:(h=$[a]).reservationId,reservationStatus:"http://schema.org/Reservation"+(h.reservationStatus||"Confirmed"),checkinUrl:h.checkinUrl,modifyReservationUrl:h.modifyReservationUrl,cancelReservationUrl:h.cancelReservationUrl,underName:{"@type":"http://schema.org/Person",name:h.name,email:h.email},provider:{"@type":"http://schema.org/Organization",name:h.provider},pickupTime:h.pickupTime,pickupLocation:{"@type":"http://schema.org/Place",name:h.pickupName,telephone:h.pickupTelephone,address:h.pickupAddress},dropoffTime:h.dropoffTime,dropoffLocation:{"@type":"http://schema.org/Place",name:h.dropoffName,telephone:h.dropoffTelephone,address:h.dropoffAddress}},h.brand&&(n.reservationFor={"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:h.brand},license:h.license,color:h.color}),b.push(n);for(a=0;a<F.length;a++)b.push(n={"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:(S=F[a]).name,email:S.email},totalPrice:C,priceCurrency:f,checkinTime:S.checkInDateTime,checkoutTime:S.checkOutDateTime,modifyReservationUrl:S.modifyReservationUrl,cancelReservationUrl:S.cancelReservationUrl,reservationStatus:"http://schema.org/Reservation"+(S.reservationStatus||"Confirmed"),reservationId:S.reservationId,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:S.hotelName,url:S.hotelUrl,telephone:S.phone,address:S.address}});if(b.length)return b}}).call();