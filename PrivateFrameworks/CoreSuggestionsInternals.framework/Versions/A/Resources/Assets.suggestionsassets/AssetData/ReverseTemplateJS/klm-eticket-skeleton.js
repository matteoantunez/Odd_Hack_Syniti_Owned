(function(){return function(e,t,r){var a,n=Scanner.fromMessage(e);n.setLocale(t);var i,g,o,s,p,m,u,l,d,c,h,C,T,b,N,v,x,f,y=[],S={};a=n.getSpan().nextText(r.confirmationCode).parentTag("table2").tagContents().innerCapture(r.confirmationCodeRegex,1),g=(I=n.getSpan().nextText(r.passengerInfo).parentTag("table2").nextTag("td2").nextTag("td2").nextTag("td2").nextTag("td2")).nextTag("td2").tagContents(),v=I.nextTag("td2").nextTag("td2").tagContents(),f=(m=I.nextTag("td2").nextTag("td2").nextTag("td2").tagContents().innerCapture(/($<programName>\D+)($<membershipNumber>\d+)/))?m.$programName:null,x=m?m.$membershipNumber:null,p=n.getSpan().nextText(r.totalPrice).nextTag("td2").tagContents().innerCapture(/($<currency>\w+)\s($<totalPrice>.+)/),S[i]={name:g,programName:f,membershipNumber:x,ticketNumber:v,seats:{},seatingType:{},totalPrice:p?p.$totalPrice:null,priceCurrency:p?p.$currency:null},n.getSpan().nextText(r.checkinUrl).nextTag("td2").innerLink(),o=n.getSpan().nextText(r.itinerary).parentTag("table2").allInnerTags("td2");for(var $=8;$<o.length;$+=14){var z;z=(z=o[$].tagContents().toString()).substring(0,2)+" "+z.substring(2,5);var k=o[$+7].tagContents();if(!(c=getFuzzyDate(n.getDetachedSpan(z+" "+k).firstDate())).toString())return CONTINUE;if(z=(z=o[$+4].tagContents().toString()).substring(0,2)+" "+z.substring(2,5),k=o[$+11].tagContents(),!(T=getFuzzyDate(n.getDetachedSpan(z+" "+k).firstDate())).toString())return CONTINUE;h=o[$+2].tagContents(),C=o[$+9].tagContents(),b=o[$+3].tagContents(),N=o[$+10].tagContents(),d=(u=o[$+1].tagContents().innerCapture(/($<code>\w+)\s($<flightNumber>\d+)/))?u.$code:null,s=u?u.$flightNumber:null,ASSERT(d,s,c,h,T,b)&&y.push({airlineCode:d,airlineName:l,flightNumber:s,departureAirport:h,departureCode:C,departureTime:c,arrivalAirport:b,arrivalCode:N,arrivalTime:T,passengers:S})}var A=[];for($=0;$<y.length;$++)for(var F=y[$],P=Object.keys(F.passengers),D=0;D<P.length;D++){var I,R={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:F.airlineName,airlineCode:F.airlineCode,flightNumber:F.flightNumber,departureAirportFuzzy:F.departureAirport,departureAirportCode:F.departureCode,departureTime:F.departureTime,arrivalAirportFuzzy:F.arrivalAirport,arrivalAirportCode:F.arrivalCode,arrivalTime:F.arrivalTime},underName:{"@type":"http://schema.org/Person",name:(I=F.passengers[P[D]]).name,email:I.email},reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:I.totalPrice,priceCurrency:I.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:I.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:I.seats[F.flightNumber],seatingType:I.seatingType[F.flightNumber]}}};valid(I.membershipNumber,I.programName)&&(R.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:I.membershipNumber,programName:I.programName}),A.push(R)}if(A.length)return A}}).call();