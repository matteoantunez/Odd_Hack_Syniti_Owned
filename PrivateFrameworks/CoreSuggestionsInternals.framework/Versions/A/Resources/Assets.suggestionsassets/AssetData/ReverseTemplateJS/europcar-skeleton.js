(function(){return function(e,t,n){var r=Scanner.fromMessage(e);r.setLocale(t);var a,p,i,o,s,c,g,d,l,m,u,h,x,C,T,v,S,f,A,k,y,R=loadHelper("europcar-microdata-parser.js")(e);if(R)return R;if(n.confirmSubject.test(e.subject)){i=r.getSpan().nextRegExp(n.reservationId).innerCapture(n.reservationId,1),a=r.getSpan().nextText(n.guestName).nextTag("td4").nextTag("td4").tagContents(),g=c=r.getSpan().nextText(n.modifyUrl).parentTag("td3").tagContents().innerLink(),m=r.getSpan().nextText(n.car).nextTag("table3").nextTag("td3").tagContents();var I=r.getSpan().nextText(n.pickup).parentTag("table3");y=I.allInnerDates(t),k=/\:/.test(y[0])?y[0]:y[1],A=I.innerPhoneNumber(),0===(f=I.next(n.pickupAddress).innerCapture(n.pickupAddress,1).trim()).toString().length&&n.pickupAddressAlt&&(f=I.next(n.pickupAddressAlt).parentTag("td3").innerCapture(n.pickupAddressAlt,1).trim());var N=r.getSpan().nextText(n.dropoff).parentTag("table3");y=N.allInnerDates(t),v=/\:/.test(y[0])?y[0]:y[1],T=N.innerPhoneNumber(),0===(C=N.next(n.pickupAddress).innerCapture(n.pickupAddress,1).trim()).toString().length&&n.pickupAddressAlt&&(C=N.next(n.pickupAddressAlt).innerCapture(n.pickupAddressAlt,1).trim());var b=r.getSpan().nextText(n.price).nextTag("td4").tagContents();0===b.toString().length&&n.priceAlt&&(b=r.getSpan().nextText(n.priceAlt).nextTag("td4").tagContents());var P=b.innerCapture(/^(.+)\(/,1);if(0===b.toString().length&&(b=P),n.priceInner)0!==b.innerCapture(n.priceInner,1).toString().length&&(b=b.innerCapture(n.priceInner,1));if(d=b.innerCapture(/([\d,.]+)/,1),l=b.innerCapture(/([^\d,.]+)/,1).trim(),!ASSERT(a,i,k,v,f,C))return CONTINUE}else if(n.cancellationSubject.test(e.subject)&&(a=r.getSpan().nextRegExp(n.cancelGuestName).tagContents().innerCapture(n.cancelGuestName,1),i=r.getSpan().nextRegExp(n.cancelReservationId).tagContents().innerCapture(n.cancelReservationId,1),o="Cancelled",k=r.getSpan().nextText(n.time).nextDate(),!ASSERT(a,i)))return CONTINUE;return m?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:d,priceCurrency:l,reservationId:i,reservationStatus:"http://schema.org/Reservation"+(o||"Confirmed"),checkinUrl:s,modifyReservationUrl:c,cancelReservationUrl:g,underName:{"@type":"http://schema.org/Person",name:a,email:p},provider:{"@type":"http://schema.org/Organization",name:"Europcar"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:m},license:u,color:h},pickupTime:k,pickupLocation:{"@type":"http://schema.org/Place",name:S,telephone:A,address:f},dropoffTime:v,dropoffLocation:{"@type":"http://schema.org/Place",name:x,telephone:T,address:C}}]:[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:d,priceCurrency:l,reservationId:i,reservationStatus:"http://schema.org/Reservation"+(o||"Confirmed"),checkinUrl:s,modifyReservationUrl:c,cancelReservationUrl:g,underName:{"@type":"http://schema.org/Person",name:a,email:p},provider:{"@type":"http://schema.org/Organization",name:"Europcar"},pickupTime:k,pickupLocation:{"@type":"http://schema.org/Place",name:S,telephone:A,address:f},dropoffTime:v,dropoffLocation:{"@type":"http://schema.org/Place",name:x,telephone:T,address:C}}]}}).call();