(function(){return function(e,t,n){function r(e){return e=e.replace(/[^\d\sa-zA-z:]+/g," ").replace(/\s+/g," ").replace(/^(\d+)\s(\d+)\s/,"$1/$2/"),e=getFuzzyDate(h.getDetachedSpan(e))}var a,i,o,c,s,u,p,l,g,m,d,C,f,S,h=Scanner.fromMessage(e);if(h.setLocale(t),!(n.emailTitelConfirmation.test(e.subject)||n.emailTitelModified.test(e.subject)||n.emailTitelCancelConfirmation.test(e.subject)))return CONTINUE;if(s=h.getSpan().innerCapture(n.reservationId,1),a=h.getSpan().innerCapture(n.guestName,1),o=h.getSpan().innerCapture(n.price,1).innerCapture(/([\d,.]+)/,1),p=r(p=h.getSpan().innerCapture(n.checkInDate,1).toString()),l=r(l=h.getSpan().innerCapture(n.checkOutDate,1).toString()),m=h.getSpan().innerCapture(n.hotelInfo,1),C=h.getSpan().innerCapture(n.hotelInfo,2),d=h.getSpan().nextPhoneNumber().nextPhoneNumber(),n.emailTitelModified.test(e.subject)&&(p=r(p=h.getSpan().innerCapture(n.checkInDateModified,1).toString()),l=r(l=h.getSpan().innerCapture(n.checkOutDateModified,1).toString()),a=h.getSpan().innerCapture(n.guestNameModified,1)),n.emailTitelConfirmation.test(e.subject)||n.emailTitelModified.test(e.subject)){if(!ASSERT(a,s,p,m))return CONTINUE;u="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(o=h.getSpan().innerCapture(n.priceCancel,1).innerCapture(/([\d,.]+)/,1),a=h.getSpan().innerCapture(n.guestNameCancel,1),!ASSERT(a,s,p,m))return CONTINUE;u="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:i},totalPrice:o,priceCurrency:c,checkinTime:p,checkoutTime:l,modifyReservationUrl:f,cancelReservationUrl:S,reservationStatus:"http://schema.org/Reservation"+(u||"Confirmed"),reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:m,url:g,telephone:d,address:C}}]}}).call();