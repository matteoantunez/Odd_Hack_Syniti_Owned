new ReverseTemplateList([new ReverseTemplate("micro-virginatlantic.com-flight-en",function(t){return/Your Virgin Atlantic itinerary confirmation|Virgin Atlantic Airways e-Ticket /.test(t.subject)},function(t,e){if(/Your Virgin Atlantic itinerary confirmation|Virgin Atlantic Airways e-Ticket /.test(t.subject)){var n=Scanner.fromMessage(t);n.setLocale("en_US");var r,i,a,o,g,s,l=loadHelper("flight_reference.js"),x=loadHelper("airline.js"),u=[],A=n.getSpan();r=A.next(/Your booking reference is/).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s([^\n]+)/,"Your booking reference is"),1);for(var p=regExpFormatted(/Flights|\1/,r.toString()),c=A.next(p).nextTag("table6"),S=0,d=c.nextAbsoluteDate(),m=0;!d.isNullSpan_&&/[\d]{2}[^\d\s]{3}|[^\d\s]{3}/.test(d.toString());)d=d.nextAbsoluteDate(),/^[^\d\s]{3}/.test(d.toString())||(1!==m?m+=1:(S+=1,m=0));for(var T=function(t){s=t.next(/Flight Number/).parentAnyTag("td").tagContents().innerCapture(/Flight Number ([A-Z]{0,2}\d{1,4})/,1),i=s.innerCapture(/(\d+)/,1);var e=s.innerCapture(/([A-Z]+)/,1);a=e.exists()?e.toString():"VS"};!c.isNullSpan_&&!regExpFormatted(/\1/,c.nextAnyTag("td").tagContents().toString()).test("Passengers");){c.next(/Depart/).parentAnyTag("td").nextAnyTag("td").nextAnyTag("td").tagContents();var f=c.next(/Depart(?:ing)?/).nextAbsoluteDate();o=combineDateAndTime(f,f.nextDate());var b=c.next(/Arriving/).nextAbsoluteDate();if(g=combineDateAndTime(b,b.nextDate()),T(c),ASSERT(i,o,g)){var D=x.airlineFromReference(a.toString());u.push(new l(D,i,s,s.toString(),o.toString(),g.toString()))}c=c.nextTag("table6")}if(0===S&&0===u.length)return CONTINUE;if(u.length!==S){u=[];for(var v=(c=A.next(p).nextTag("table6")).next(/Departing/).previousAnyTag("tr");!v.isNullSpan_;){f=v.next(/Depart(?:ing)?/).nextAbsoluteDate();o=combineDateAndTime(f,f.nextDate());b=v.next(/Arriving/).nextDate();g=combineDateAndTime(b,b.nextAbsoluteDate()),T(v);D=x.airlineFromReference(a.toString());ASSERT(a,i,o,g)&&u.push(new l(D,i.toString(),s,s.toString(),o.toString(),g.toString())),v=v.next(/Departing/).next(/Departing/).previousAnyTag("tr")}}return loadHelper("flight_generic.js")(t,e,u)}},"SGb3000175")]);