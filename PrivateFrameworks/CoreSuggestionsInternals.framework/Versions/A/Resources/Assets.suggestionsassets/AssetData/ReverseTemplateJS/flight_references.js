(function(){return function(e,r,n){var i=[],s=loadHelper("flight_reference.js"),o=loadHelper("airline.js"),a=loadHelper("airlines.js"),t=a.map(function(e){if(!e.blacklisted)return e.IATA}),l=a.map(function(e){return e.ICAO}),u=[].concat.apply([],a.map(function(e){return e.domains})),c=[].concat.apply([],a.map(function(e){return e.names})),d=loadHelper("blacklist_references.js"),f=!!loadHelper("iata_keyword_domains.js").includes(n.domain),g=/[A-Z]{2}|[A-Z][0-9]|[0-9][A-Z]/,m=/[A-Z]{3}/,p="";c.forEach(function(e){p+=e+"|",p+=e+"Flight|"}),p=new RegExp(p.slice(0,-1),"i");var h=/(\n?\n?flight(\n?\n?|\/\s*OPERATED BY)|vuelo(?:\/\s*OPERADO POR)?|\ud3b8\uba85|n\xfamero de vuelo|vuelo \u2116|flug-\snummer|flight[\n\s]?number|vluchtnummer|numero\sdi\svolo|\n?\n?flight\s?\/\soperated[\xa0\s]by\s\n?\n?)\s?#?/i,x=/(^\s[0-9]{1,4}$|^[0-9]{1,4}$)/,_=/(\s|flight|\(|:|diretto|direct|\[|\u2022)/i,v=/(\s|\)|,\s|\n|\/|\*|\u4fbf|\ud3b8|\uff08|\u3011|\()/,w=/(\*\s|\s ?|\s#| ?- ?)?/i,O=/(\*\s|\s\s?\s?|,?\s?\sflight\s|\s-\sflight\s|\s#\s?|\s?\nvuelo\s:?\s?|\s\s?(?:(Op\xe9r\xe9 par|Operated By|Betrieben von):.{1,30}\s+)?(?:\u30d5\u30e9\u30a4\u30c8:|\ud56d\uacf5\ud3b8:|Volo?:|Flight:|Flug:)\s)?/i,y=/[0-9]{1,4}/,A=[];return[{id:"iata",regex:g,separator_regex:w,whitelist:t,use_domain:!1},{id:"airlineName",regex:p,separator_regex:O,whitelist:c,use_domain:!1},{id:"icao",regex:m,separator_regex:w,whitelist:l,use_domain:!1},{id:"keyword",regex:/(flight(?:\s+?)?(?:number)?|flug|vlucht|vuelo ?|voo(?:\s+?)?|volo|vol):?-?\s?#?/i,separator_regex:O,whitelist:u,use_domain:!0},{id:"keywordColumn",regex:h,separator_regex:O,whitelist:u,use_domain:!0}].forEach(function(e){A.push({id:e.id,scanner_regex:new RegExp(_.source+"("+e.regex.source+")"+e.separator_regex.source+y.source+v.source,"ig"),reference_regex:e.regex,whitelist:e.whitelist,use_domain:e.use_domain})}),A.forEach(function(e){if(!(i.length>=1&&!1===f)){var t=[];t="keywordColumn"===e.id?loadHelper("column_extractor.js")(r,h,x):r.content_.match(e.scanner_regex);var l=r.getSpan();t&&t.length>=1&&t.forEach(function(t){var u=t.trim().replace(/[()\n,\/\uff08\u3011]/g,"");if(!(d.indexOf(u)>-1)){var c="";if(!0===e.use_domain?c="webpage"===n.documentType||n.from.indexOf("safari")>-1?n.senderDomain.toLowerCase():n.from.toLowerCase():(c=e.reference_regex.exec(u))&&c[0]&&(c=c[0].toLowerCase()),e.whitelist.toString().toLowerCase().indexOf(c)>-1){var f=/^([0-9]+)$/;u.match(f)||(f=/.{2,}?([\d]{1,4})\b/);var g=u.match(f),m=loadHelper("skip_for_domain.js")[n.senderDomain];m&&m.test(r.getSpan())&&(l=r.getSpan().next(m),t=t.trim());var p=new s(o.airlineFromReference(c,a),g[1].replace(/^0+/,""),l.next(t),u.toString());!1===i.some(function(e){if(e.equals(p))return!0})&&(i.push(p),l=p.span)}}})}}),i}}).call();