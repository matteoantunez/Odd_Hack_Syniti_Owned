(function(){return function(e,t,r){var a,n,i,l,o,p,g,s,m,u,h,d,c,T,C,v=Scanner.fromMessage(e);v.setLocale(t);var f=[],b=[],y=[];for(a=v.getSpan().innerCapture(regExpFormatted(/\1\s+(\w+)/,r.reservationId),1),p=v.getSpan().next(r.checkIn).nextLink(),s=v.getSpan().next(r.passengerDetails).parentAnyTag("table").allInnerTags("tr2"),g=1;g<s.length;g++)u={},(m=s[g].allInnerTags("td2")).length>2&&(u.name=m[0].tagContents(),u.ticketNumber=m[1].tagContents().innerCapture(/(\d+)/,1),u.seats=m[2].tagContents().split(","),ASSERT(u.name)&&f.push(u));for(d=v.getSpan().next(r.flightDetails).nextTag("table3").allInnerTags("tr3"),g=0;g<d.length;g++)h={},(m=d[g].allInnerTags("td3")).length>2&&((c=m[0].allInnerDates()).length>1?(n=c[0],i=c[1]):n=i=c[0],h.departureTime=combineDateAndTime(n,m[1].innerDate()),h.departureAirport=m[1].tagContents().innerCapture(/(.*)\n/,1),h.arrivalTime=combineDateAndTime(i,m[2].innerDate()),h.arrivalAirport=m[2].tagContents().innerCapture(/(.*)\n/,1),T=m[3].innerCapture(/($<airlineCode>\w+)\s($<flightNumber>\d+)/),h.airlineCode=T.$airlineCode,h.flightNumber=T.$flightNumber,h.seatingType=m[4].tagContents().innerCapture(/\n(.*)/,1),ASSERT(h.departureAirport,h.arrivalAirport,h.departureTime,h.arrivalTime,h.airlineCode,h.flightNumber)&&b.push(h));for(C=r.bookingPending?"Pending":"Confirmed",g=0;g<b.length;g++){h=b[g];for(var A=0;A<f.length;A++){var N={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Etihad",airlineCode:h.airlineCode,flightNumber:h.flightNumber,departureAirportFuzzy:h.departureAirport,departureTime:h.departureTime,arrivalAirportFuzzy:h.arrivalAirport,arrivalTime:h.arrivalTime},underName:{"@type":"http://schema.org/Person",name:(u=f[A]).name},checkinUrl:p,reservationId:a,reservationStatus:"http://schema.org/Reservation"+C,totalPrice:l,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:u.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:u.seats[g].trim(),seatingType:h.seatingType}}};y.push(N)}}if(y.length)return y}}).call();