(function(){return function(e,r,t){var a,i,n,p,l,o,m,s,u,d=[],g={},h=Scanner.fromMessage(e);for(h.setLocale(r),n=h.getSpan().innerCapture(regExpFormatted(/\1\n\n(.*)/,t.reservationId),1),s=h.getSpan().next(t.reservationId).parentTag("table2").allInnerTagsFiltered("td4").filter(function(e){return e.innerCapture(/^[A-Z\d]{2} \d{2,4}$/)}),l=0;l<s.length;l++){if(m={},"zh_Hans_CN"===r||"ja_JP"===r){var v=s[l].previousTag("td2").innerCapture(/.*,\s(.*)\s(.*)\u6708\s(.*)/);o=v[1]+"-"+("0"+v[2]).slice(-2)+"-"+("0"+v[3]).slice(-2)}else{var c=s[l].previousDate();for(o=!1,b=0;b<2*s.length&&!o;b++)hasTime_(unSpanDate_(c))||(o=c),c=c.previousDate()}a=s[l].nextDate(),m.departureCode=a.parentAnyTag("td").innerCapture(/\((.*?)[\)\s-]/,1),i=a.nextDate(),m.arrivalCode=i.parentAnyTag("td").innerCapture(/\((.*?)[\)\s-]/,1),u=s[l].innerCapture(/($<airlineCode>\D+)\s+($<flightNumber>\d+)/),m.airlineCode=u.$airlineCode,m.flightNumber=u.$flightNumber,m.departureTime=combineDateAndTime(o,a),m.arrivalTime=combineDateAndTime(o,i),Date.parse(m.departureTime)>Date.parse(m.arrivalTime)&&(m.arrivalTime=modifyDate(m.arrivalTime,1)),ASSERT(m.departureTime,m.arrivalTime,m.airlineCode,m.flightNumber,m.departureCode,m.arrivalCode)&&d.push(m)}g=h.getSpan().allInnerCapture(/\[table4\]\s\[tr4\]\s\[td4\]([^\[\]:><\uff1a\/]{4,})\[\/td4\]\s\[td4\]\s{3}/,1),ASSERT(g.length>0);var T,C=[];for(l=0;l<d.length;l++){m=d[l];for(var b=0;b<g.length;b++){var f=g[b].parentTag("table4").allInnerTags("td5")[2*l+1].tagContents().innerCapture(/(\d{1,2}[A-Za-z])/,1),y=g[b].toString().trim();T={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineCode:m.airlineCode,flightNumber:m.flightNumber,departureAirportFuzzy:m.departureAirport,departureAirportCode:m.departureCode,departureTime:m.departureTime,arrivalAirportFuzzy:m.arrivalAirport,arrivalAirportCode:m.arrivalCode,arrivalTime:m.arrivalTime},underName:{"@type":"http://schema.org/Person",name:y},checkinUrl:p,reservationId:n,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:null,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:f,seatingType:null}},totalPrice:null,priceCurrency:null,reservationStatus:"http://schema.org/ReservationConfirmed"},valid(y.membershipNumber)&&(T.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:y.membershipNumber,programName:"Frequent Flyer"}),C.push(T)}}if(C.length)return C}}).call();