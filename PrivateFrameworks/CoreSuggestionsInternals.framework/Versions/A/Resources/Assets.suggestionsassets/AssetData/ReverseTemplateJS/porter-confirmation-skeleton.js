(function(){return function(e,t,r){var i=Scanner.fromMessage(e);i.setLocale(t);var a,n,p,o,g,l,s,u,m,d,f,h,c,x,v,A,S,T,C,y=[],D=[];a=i.getSpan().innerCapture(regExpFormatted(/\1\s*(.+)/,r.reservationIdPrefix),1).trim(),n=i.getSpan().next(r.checkinUrlPrefix).nextLink(),(A=i.getSpan().next(r.pricePrefix).nextTag("td2").tagContents()).exists()&&(S=A.innerCapture(/([\d,.]+)/,1),T=A.innerCapture(/([^\d$,.]+)/,1).trim()),(v=i.getSpan().next(r.passengerPrefix).parentAnyTag("table")).exists()&&(y=v.allInnerTagsFiltered("td2").map(function(e){return e.toString().trim()}).filter(function(e){return!r.passengerPrefix.test(e)&&!/^</.test(e)})),x=i.getSpan().next(r.flightNumberRegExp);do{var z;(p=x.previousTag("table3").innerDate())===C&&z&&(p=z);var E=x.innerCapture(r.flightNumberRegExp);o=E[1],g=E[2];var F=x.next(r.flightTimeAirportRegExp),R=!1;if(F.exists()||(R=!0,F=x.next(r.ftarAlternate)),F.exists()){var N=F.innerCapture(R?r.ftarAlternate:r.flightTimeAirportRegExp),b=[N[0],N[1],N[2],R?null:N[3]];if(s=b[1],u=b[2],m=b[3],(F=F.nextTag("td2").next(R?r.ftarAlternate:r.flightTimeAirportRegExp)).exists()){var P=[(N=F.innerCapture(R?r.ftarAlternate:r.flightTimeAirportRegExp))[0],N[1],N[2],R?null:N[3]];f=P[1],h=P[2],c=P[3],l=i.getDetachedSpan(s.toString()+", "+p.toString()).innerDate(),d=i.getDetachedSpan(f.toString()+", "+p.toString()).innerDate(),r.arriveNextDay.test(F.getString())&&(z=(d=modifyDate(d,1)).split(/\s/)[0]),i.getDateDD(l).iso8601>i.getDateDD(d).iso8601&&(z=(d=modifyDate(d,1)).split(/\s/)[0]),R&&(c=h.getString().trim(),h=null),ASSERT(o,g)&&D.push({airlineCode:o,flightNumber:g,departureTime:l,departureAirportFuzzy:u,departureAirportCode:m,arrivalTime:d,arrivalAirportFuzzy:h,arrivalAirportCode:c})}}C=x.previousTag("table3").innerDate(),x=x.next(r.flightNumberRegExp)}while(x.exists());var k=[];if(D.forEach(function(e){y.forEach(function(t){ASSERT(t,a)&&k.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirportFuzzy,departureAirportCode:e.departureAirportCode,departureTime:e.departureTime,arrivalAirportFuzzy:e.arrivalAirportFuzzy,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalTime},underName:{"@type":"http://schema.org/Person",name:t},checkinUrl:n,reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:S,priceCurrency:T,reservedTicket:{"@type":"http://schema.org/Ticket",ticketedSeat:{"@type":"http://schema.org/Seat"}}})})}),k.length)return k}}).call();