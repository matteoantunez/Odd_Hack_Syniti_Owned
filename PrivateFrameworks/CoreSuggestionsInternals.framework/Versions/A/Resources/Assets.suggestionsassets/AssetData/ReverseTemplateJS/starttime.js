(function(){return function(t,e,n,i){function r(e,n){if("undefined"!=typeof t.skipDate&&e&&e.exists())for(o=0;o<t.skipDate.length&&e&&e.exists();o+=1){for(var i=n.next(t.skipDate[o]),r=!1;i.exists();)i.exists()&&i.getStart()<=e.getStart()&&i.getEnd()>e.getStart()&&(e=e.nextAbsoluteDate(),r=!0),i=i.next(t.skipDate[o]);e.exists()&&r&&(o=-1)}return e}function s(n){function i(n){for(o=0;o<t.skipTime.length;o++){var i=e.getSpan().next(t.skipTime[o]);if(i.exists()&&i.getStart()<=n.getStart()&&i.getEnd()>n.getStart())return!0}return!1}for(var r=null!==n?n.length:0,s=0;s<r;s++){var a=n[s];if(hasTime(a)){if(/^00/.test(a.toString()))break;if(t.skipTime&&t.skipTime.length>0&&i(a))continue;return a}}return null}var a,o,u,g;if("undefined"!=typeof t.dateCapture)for(o=0;o<t.dateCapture.length&&(!u||!u.exists());o++)if((a=e.getSpan().innerCapture(t.dateCapture[o],1))&&(u=a.innerDate()).exists())return u;var l=e.getSpan().allAbsoluteDates().filter(function(n){return/[\d\uff10-\uff19]{1,2}/.test(n.toString())&&(!(i&&i.exists())||i&&i.exists()&&!i.toString().includes(n.toString()))&&!t.footer.map(function(t){return e.getSpan().next(t)}).filter(function(t){return t.exists()}).some(function(t){return t.contains(n)})});if(0===l.length){if(n&&(!u||!u.exists())){var f=n.subject.replace(/\r?\n/gm," ").replace(/\s+/g," "),x=e.getDetachedSpan(f);u=x.innerAbsoluteDate(),i&&i.exists()&&i.toString().includes(u.toString())&&(u=e.getNullSpan()),(u=r(u,x))&&u.exists()&&!hasTime(u)&&(g=s(l=e.getSpan().allDates().filter(function(t){return/[\d\uff10-\uff19]{1,2}/.test(t.toString())})))&&(u=combineDateAndTime(u,g))}if(n&&i&&i.exists()&&(!u||!u.exists())){var p=t.buildRegExp("dateCaptureHTMLFromName",i.toString());for(o=0;o<p.length&&(!u||!u.exists());o++){(d=p[o].exec(n.html))&&2===d.length&&(u=e.getDetachedSpan(d[1]).innerDate())}}if(n&&(!u||!u.exists())&&"undefined"!=typeof t.dateCaptureHTML)for(o=0;o<t.dateCaptureHTML.length&&(!u||!u.exists());o++){var d;(d=t.dateCaptureHTML[o].exec(n.html))&&2===d.length&&(u=e.getDetachedSpan(d[1]).innerDate())}var S;if(u&&u.exists()&&!hasTime(u)&&"undefined"!=typeof t.timeCaptureHTML)for(o=0;o<t.timeCaptureHTML.length&&(!S||!S.exists());o++){var D=t.timeCaptureHTML[o].exec(n.html);D&&2===D.length&&(S=e.getDetachedSpan(D[1]).innerDate())&&S.exists()&&(u=combineDateAndTime(u,S))}return!n||u&&u.exists()||!i||!i.exists()||(u=/[\d\uff10-\uff19]{1,2}/.test(i.innerDate().toString())&&!/^[\d\uff10-\uff19]{1,2}(?:\:[\d\uff10-\uff19]+\s*?)?(?:[ap]\.?m\.?)?$/.test(i.innerDate().toString())?i.innerDate():e.getNullSpan()),u}if(i&&i.exists()){function c(t,e){return e.innerAbsoluteDate().exists()?t.trim().toString()===e.toString()?t.nextAbsoluteDateFromEnd():t.collapseToInnerEnd(e.toString()).nextAbsoluteDate():t.innerAbsoluteDate().exists()?t.innerAbsoluteDate():t.nextAbsoluteDate()}var m=t.buildRegExp("dateFromEventName",i.toString());for(o=0;o<m.length&&(!a||!a.exists());o++){for(var h=e.getSpan().next(m[o]),T=c(h,i);T.exists()&&(T.start_-h.end_>=350||T.toString()===i.innerAbsoluteDate().toString());)T=c(h=h.next(m[o]),i);(a=T).exists()&&(u=a)}}if("undefined"!=typeof t.date)for(o=0;o<t.date.length&&(!a||!a.exists());o++)(a=e.getSpan().next(t.date[o]).nextAbsoluteDate()).exists()&&(u=r(a,e.getSpan()));return u&&u.exists()||(u=l.shift())&&u.exists()&&e.getDateDD(u).endIso8601.length>0&&(u=e.getDetachedSpan(e.getDateDD(u).iso8601).innerDate()),(u=r(u,e.getSpan()))&&u.exists()&&!hasTime(u)&&(g=s(l=e.getSpan().withStart(u.getEnd()).allDates().filter(function(t){return/[\d\uff10-\uff19]{1,2}/.test(t.toString())})))&&(u=combineDateAndTime(u,g)),u}}).call();