(function(){return function(e,r,t){function a(){return c.toString().indexOf("AMERICAN AIRLINES")>=0?"AA":c.toString().indexOf("US AIRWAYS")>=0?"US":""}var n,i,o,p=Scanner.fromMessage(e);p.setLocale(r);var s,g,l,m,u,h,d,c,v,f,y,T,b,C=[],N={};if(u={},(d=p.getSpan().next(t.travelerInformation).nextTag("table2").allInnerTags("tr2")).length)for(var S=1;S<d.length;S++)3===(m=d[S].allInnerTags("td2").map(function(e){return e.tagContents()})).length&&(u[s=m[0].toString()]||(u[s]={seat:[],seatingType:[]}),u[s].seat.push(m[2]),u[s].seatingType.push(m[1]));if((l=p.getSpan().next(t.yourItinerary).nextTag("table1").allInnerTags("tr1")).length>2)for(S=2;S<l.length;S++)if(8===(h=l[S].allInnerTags("td1").map(function(e){return e.tagContents()})).length){c=h[0];var A=h[1];if(y=h[2].innerCapture(/^([A-Z]{3})/,1),/\uc6d4|\u5e74/.test(h[3])&&(h[3]=h[3].replace(/(\d{4})[ \u5e74](\d{1,2})[\uc6d4\u6708]\s?(\d{1,2})\u65e5?/,"$2/$3/$1").replace(/\n/," ")),f=getFuzzyDate(h[3]),b=h[4].innerCapture(/^([A-Z]{3})/,1),/\uc6d4|\u5e74/.test(h[5])&&(h[5]=h[5].replace(/(\d{4})[ \u5e74](\d{1,2})[\uc6d4\u6708]\s?(\d{1,2})\u65e5?/,"$2/$3/$1").replace(/\n/," ")),T=getFuzzyDate(h[5]),ASSERT(c,A,y,f,b,T)){g=Object.keys(u),N={};for(var I=0;I<g.length;I++)N[g[I]]={name:g[I],seat:u[g[I]].seat[C.length],seatingType:u[g[I]].seatingType[C.length]};v=a(c),n=p.getSpan().innerCapture(regExpFormatted(/\1 \2:\s+(\w{6})/,v,t.recordLocator),1),not(n)&&(n=p.getSpan().innerCapture(regExpFormatted(/\b\1:\s+(\w{6})/,t.recordLocator),1)),C.push({airlineName:c,airlineCode:v,flightNumber:A,reservationId:n,departureCode:y,departureTime:f,arrivalCode:b,arrivalTime:T,passengers:N})}}var z=[];for(S=0;S<C.length;S++){var F=C[S],x=Object.keys(F.passengers);for(I=0;I<x.length;I++){var k=F.passengers[x[I]],R={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:F.airlineName,airlineCode:F.airlineCode,flightNumber:F.flightNumber,departureAirportFuzzy:F.departureAirport,departureAirportCode:F.departureCode,departureTime:F.departureTime,arrivalAirportFuzzy:F.arrivalAirport,arrivalAirportCode:F.arrivalCode,arrivalTime:F.arrivalTime},underName:{"@type":"http://schema.org/Person",name:k.name},checkinUrl:i,reservationId:F.reservationId,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:k.totalPrice,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:k.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:k.seatingType,seatNumber:k.seat}}};valid(k.membershipNumber)&&(R.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:k.membershipNumber,programName:k.programName}),z.push(R)}}if(z.length)return z}}).call();