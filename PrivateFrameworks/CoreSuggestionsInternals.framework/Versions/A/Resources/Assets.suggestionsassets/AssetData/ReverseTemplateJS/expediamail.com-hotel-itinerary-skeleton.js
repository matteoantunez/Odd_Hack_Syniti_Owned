(function(){return function(e,t,n){if(!e||!t||!n)return CONTINUE;e.plain=e.plain.replace(/mrt/g,"mar");var a,r,i,c,s,l,d,g,o,p,h,D,u=Scanner.fromMessage(e);u.setLocale(t),""===(a=u.getSpan().next(n.hotelDetails).next(n.reservedFor).nextAnyTag("td").tagContents()).toString()&&(a=a.nextAnyTag("td").tagContents()),a=a.innerCapture(/(\w+?\s.*?)\s/,1).trim(),i=u.getSpan().innerCapture(regExpFormatted(/\s\1 (\d+)/,n.reservationId),1);var m,S=u.getSpan().next(n.check).parentAnyTag("table");do{if(""!==(m=S.allInnerTagsFiltered("td5")[0])&&m!==undefined){p=m;break}S=S.previousAnyTag("table")}while(S.exists());if(valid(S)&&(r=S.allInnerTagsFiltered("td5"),/\//.test(r[1])&&(r[1]=r[1].replace(/\//g," ")),r.length>=2))if(d=u.getDateDD(r[1].innerDate()),valid(d)&&"fr_FR"!==t)o=u.getDetachedSpan(d.endIso8601),g=u.getDetachedSpan(d.iso8601);else if(r[1].innerText("/").exists()){var v,k,x=r[1].innerCapture(/($<checkInDate>\d{4}\/\w+\/\d+).+($<checkOutDate>\d{4}\/\w+\/\d+)/);x&&x.$checkInDate&&x.$checkOutDate?((v=x.$checkInDate.toString().split("/")).length>=3&&(g=u.getDetachedSpan(v[1]+"/"+v[2]+"/"+v[3]).innerDate()),(k=x.$checkOutDate.toString().split("/")).length>=3&&(o=u.getDetachedSpan(k[1]+"/"+k[2]+"/"+k[3]).innerDate())):(x=r[1].innerCapture(/($<checkInDate>\d+\/\w+\/\d{4}).+($<checkOutDate>\d+\/\w+\/\d{4})/))&&x.$checkInDate&&x.$checkOutDate&&(g=u.getDetachedSpan(x.$checkInDate.toString().replace("/"," ")).innerDate(),o=u.getDetachedSpan(x.$checkOutDate.toString().replace("/"," ")).innerDate())}else{var T=r[1].toString().replace(/\,/g,"").split("-");g=u.getDetachedSpan(T[0]).innerDate(),o=u.getDetachedSpan(T[1]).innerDate()}if("ja_JP"===t){for(var f=u.getSpan().next("\u30db\u30c6\u30eb\u306e\u8a73\u7d30\u3092\u8868\u793a\u3059\u308b"),$=f.allInnerAbsoluteDates();!f.isNullSpan_&&0===$.length;)$=(f=f.previousAnyTag("td")).allInnerAbsoluteDates();var C=$[0].innerCapture(/($<first>[\d\,\-\\\/ ]+)\s-\s($<second>[\d\,\-\\\/ ]+)/);o=C?C.$second.replace(/\//,"-"):null,g=C?C.$first.replace(/\//,"-"):null}D=(r=u.getSpan().next(n.hotelDetails).parentAnyTag("td").tagContents()).innerCapture(regExpFormatted(/\1.*?>\s+(.*?)[<|\n]/,n.hotelDetails),1).trim(),r.innerAddress().getLength()>=D.getLength()&&(D=r.innerAddress()),h=r.innerCapture(regExpFormatted(/\b\1 ([-\d\(\) ]+),/,n.telephone),1),l=(l=u.getSpan().next(n.checkin).next(n.checkinTime).parentAnyTag("td").innerCapture(regExpFormatted(/(\1\s*.*)/,n.checkinTime),1)).innerDate().exists()?l.innerDate():l,valid(g,l)&&(g=combineDateAndTime(g,l));var I="Confirmed";return n.cancelled.test(e.plain)&&(I="Cancelled"),e.to,ASSERT(D,g)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a},checkinTime:g,checkoutTime:o,modifyReservationUrl:c,cancelReservationUrl:s,reservationStatus:"http://schema.org/Reservation"+I,reservationId:i,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:p,telephone:h,address:D}}]:void 0}}).call();