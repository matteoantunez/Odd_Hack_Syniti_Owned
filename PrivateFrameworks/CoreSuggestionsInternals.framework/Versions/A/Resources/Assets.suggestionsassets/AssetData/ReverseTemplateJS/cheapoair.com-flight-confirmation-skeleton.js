(function(){return function(e,r,t){function a(){ASSERT(C.airlineName,C.flightNumber,C.departureAirportCode,C.departureDateTime,C.arrivalAirportCode,C.arrivalDateTime)&&(v.push(C),C={},b=!1)}var i=Scanner.fromMessage(e);i.setLocale(r);for(var n=i.getSpan().nextText(t.customerInformationHeader).parentTag("table6"),o=i.getSpan().nextText(t.flightSummaryHeader).nextTag("table8").allInnerTagsFiltered("td8"),m=[],p=0;p<parseInt((o.length-4)/4);p++){var l=o[4*p+4].innerCapture(/[a-zA-Z,\s]+/)[0],g=o[4*p+5].innerCapture(/[A-Za-z0-9]+/),d=g?g[0]:null;ASSERT(l)&&m.push({travelerName:l,ticketNumber:d})}var s,u,x,f,h,N,T=n.nextText(t.flightDetails).nextTag("table6").nextTag("table6").nextTag("table6").nextTag("table7").allInnerTags("tr7").filter(function(e){return e.tagContents().toString().length}),v=[],C={},b=!1;for(p=0;p<T.length;p++)(s=T[p]).innerText(t.operatedByPrefix).exists()?C.airlineName=s.innerText(t.operatedByPrefix).parentTag("td7").tagContents().innerCapture(regExpFormatted(/\1 (.+)/,t.operatedByPrefix),1):(s.innerText(t.flightNumberPrefix).exists()&&s.innerText(t.fromPrefix).exists()&&s.innerText(t.toPrefix).exists()&&(b&&a(),s.innerText(t.reservationIdPrefix).exists()?(x=s.firstTag("td7").tagContents().innerCapture(regExpFormatted(/^($<airlineName>.+)\n\1\s($<flightNumber>\d+)[^]+\2:\s($<reservationId>\w+)/,t.flightNumberPrefix,t.reservationIdPrefix)),C.airlineName=x.$airlineName.trim(),C.flightNumber=x.$flightNumber.trim(),C.reservationId=x.$reservationId.trim()):(u=s.firstTag("td7").tagContents().innerCapture(regExpFormatted(/^($<airlineName>.+)\n\1\s($<flightNumber>\d+)/,t.flightNumberPrefix)),C.airlineName=u.$airlineName.trim(),C.flightNumber=u.$flightNumber.trim()),f=(h=s.nextTag("td7").nextTag("td7").tagContents()).innerCapture(/($<airportName>.+)\(($<airportCode>\w{3})\)/),C.departureAirportName=f.$airportName.trim(),C.departureAirportCode=f.$airportCode.trim(),C.departureDateTime=h.innerDate(),f=(N=h.nextTag("td7")).innerCapture(/($<airportName>.+)\(($<airportCode>\w{3})\)/),C.arrivalAirportName=f.$airportName.trim(),C.arrivalAirportCode=f.$airportCode.trim(),C.arrivalDateTime=N.innerDate(),b=!0),s.innerTag("table8").exists()&&a());for(var c=[],A=0;A<v.length;A++)for(var $=v[A],S=0;S<m.length;S++){var y=m[S],I=y.travelerName.toString().trim();c.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:$.airlineName,airlineCode:$.airlineCode,flightNumber:$.flightNumber,departureAirportFuzzy:$.departureAirportName,departureAirportCode:$.departureAirportCode,departureTime:$.departureDateTime,arrivalAirportFuzzy:$.arrivalAirportName,arrivalAirportCode:$.arrivalAirportCode,arrivalTime:$.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:I},reservationId:$.reservationId,reservationStatus:"http://schema.org/ReservationConfirmed",reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:y.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat"}}})}return c}}).call();