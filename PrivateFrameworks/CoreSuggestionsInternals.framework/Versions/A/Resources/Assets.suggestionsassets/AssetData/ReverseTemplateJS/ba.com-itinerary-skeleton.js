(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,p,o,s,u=[],l=[];t.reservationId.test(e.subject)&&(o=t.reservationId.exec(e.subject)[1]);for(var g=a.getSpan().next(t.itinerary);g.exists();)i={},n=regExpFormatted(/\1\s*(.*)/,t.departureAirport),i.departureAirport=g.next(n).innerCapture(n,1),n=regExpFormatted(/\n\1\s*(.*)/,t.arrivalAirport),i.arrivalAirport=g.next(n).innerCapture(n,1),n=regExpFormatted(/\1\s*($<airlineCode>\D+)($<flightNr>\d+)/,t.flight),p=g.next(n).innerCapture(n),i.airlineCode=p.$airlineCode,i.flightNumber=p.$flightNr,n=regExpFormatted(/\1\s*\D+\s+(.*)/,t.depart),i.departureDate=a.getDetachedSpan(g.next(n).innerCapture(n,1).toString().replace(/\,/g,"")).innerDate(),n=regExpFormatted(/\1\s*\D+\s+(.*)/,t.arrival),i.arrivalDate=a.getDetachedSpan(g.next(n).innerCapture(n,1).toString().replace(/\,/g,"")).innerDate(),n=regExpFormatted(/\1\s*(.*)/,t.cabin),i.seatType=g.next(n).innerCapture(n,1),n=regExpFormatted(/\1\s*(.*)/,t.codeShare),i.airlineName=g.next(n).innerCapture(n,1),n=regExpFormatted(/\1\s*(.*)/,t.passenger),i.passengerName=g.next(n).innerCapture(n,1),ASSERT(i.airlineName,i.airlineCode,i.flightNumber,i.departureDate,i.departureAirport,i.arrivalDate,i.arrivalAirport)&&l.push(i),g=g.next(t.itinerary);for(var d=0;d<l.length;d++){u.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:(s=l[d]).airlineName,airlineCode:s.airlineCode,flightNumber:s.flightNumber,departureAirportFuzzy:s.departureAirport,departureTime:s.departureDate,arrivalAirportFuzzy:s.arrivalAirport,arrivalTime:s.arrivalDate},underName:{"@type":"http://schema.org/Person",name:s.passengerName},reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:s.price,priceCurrency:s.currency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:s.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:s.seatNumber,seatingType:s.seatType}}})}if(u.length)return u}}).call();