(function(){return function(e,t,n){var r,a,i,p,s,o,u,c,m,g,l,C,S,h,d=Scanner.fromMessage(e);if(d.setLocale(t),!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;if(s=d.getSpan().innerCapture(n.reservationId,1),r=d.getSpan().innerCapture(n.guestFirstName,1),a=d.getSpan().innerCapture(n.guestEmail,1),u=d.getSpan().nextRegExp(n.checkInDate).nextDate(),c=d.getSpan().nextRegExp(n.checkOutDate).nextDate(),i=(f=d.getSpan().innerCapture(n.price,1)).innerCapture(/([\d,.]+)/,1),p=f.innerCapture(/([^\d,.]+)/,1).trim(),g=d.getSpan().innerCapture(n.hotelName,1),(C=d.getSpan().innerCapture(regExpFormatted(/\1.+\n.*\n.*\n.*\n.*([\s\S]*)\2/,n.guestEmail,n.hotelPhone),2).trim())||(C=d.getSpan().nextRegExp(n.guestEmail).nextAddress()),l=d.getSpan().innerCapture(n.hotelPhone,1),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(r,s,u,c,C))return CONTINUE;o="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){var f;if(s=d.getSpan().innerCapture(n.cancelReservationId,1).trim(),r=d.getSpan().innerCapture(n.guestFirstName,1)+" "+d.getSpan().innerCapture(n.guestLastName,1),a=d.getSpan().innerCapture(n.cancelGuestEmail,1),i=(f=d.getSpan().innerCapture(n.cancelPrice,1)).innerCapture(/([\d,.]+)/,1),p=f.innerCapture(/([^\d,.]+)/,1).trim(),!ASSERT(r,s,u,g))return CONTINUE;o="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:a},totalPrice:i,priceCurrency:p,checkinTime:u,checkoutTime:c,modifyReservationUrl:S,cancelReservationUrl:h,reservationStatus:"http://schema.org/Reservation"+(o||"Confirmed"),reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:g,url:m,telephone:l,address:C}}]}}).call();