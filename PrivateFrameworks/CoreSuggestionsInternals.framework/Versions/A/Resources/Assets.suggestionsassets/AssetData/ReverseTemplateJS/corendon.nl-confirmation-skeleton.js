(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,o,p,s,l,g,m,d,c=a.getSpan();i=c.innerCapture(regExpFormatted(/\1 (.*)/,t.underPersonName_prefix),1),n=c.innerCapture(regExpFormatted(/\1 (.*)/,t.underPersonEmail_prefix),1),c.innerCapture(regExpFormatted(/\1 (.*)/,t.underPersonPhone_prefix),1),o=c.innerCapture(regExpFormatted(/\1 (.*)/,t.reservationId_prefix),1);var u=c.nextText(t.totalPrice_prefix).nextTag("td4").tagContents().toString();if(p=u.substring(1),s=u[0],g=m=d=c.nextText(t.checkinUrl_prefix).nextLink(),!(c.nextText(t.isHotelEmail).toString().length>0)){var h=[],v=[];h=c.nextText(t.reservationForBlock_prefix).nextTag("table4").allInnerTags("tr4");var x=c.innerCapture(regExpFormatted(/\1 (.*) [0-9] P\./,t.airportCode_prefix),1).split(" - ");return function(e,r){e.forEach(function(e,t){var i=e.allInnerTags("td4");if(1===i.length&&0!==i[0].tagContents().toString().length){var n,o,p,s,l,g,m,d,c,u=(e=i[0]).tagContents().toString().split("\n");n=l=u[0].trim(),o=u[3].split("-")[0].trim(),g=u[3].split("-")[1].trim(),p=n+", "+o,p=getFuzzyDate(a.getDetachedSpan(p).firstDate()),m=l+", "+g,m=getFuzzyDate(a.getDetachedSpan(m).firstDate()),s=u[4].split("-")[0].trim(),d=u[4].split("-")[1].trim(),Date.parse(m)<Date.parse(p)&&(m=modifyDate(m,1));var h=/^([a-zA-Z0-9]+) ([a-zA-Z0-9]+) (.*)/.exec(u[2]);c=loadHelper("icaoCodeToIataCode.js")(h[1]),r({airlineName:h[3],airlineCode:c,flightNumber:h[2],departureDateTime:p,departureAirport:s,departureAirportCode:x[t/2].toString().toUpperCase(),arrivalDateTime:m,arrivalAirport:d,arrivalAirportCode:x[t/2+1].toString().toUpperCase()})}})}(h,function(e){ASSERT(e.flightNumber,e.departureAirport,e.arrivalAirport)&&v.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:i},checkinUrl:g,reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:p,priceCurrency:s,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:l,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}}})}),v.length>=1?v:CONTINUE}var f,C,T,y,A,S,F="Confirmed",N=c.nextText(t.reservationForBlock_prefix).nextTag("table4").nextTag("td4").tagContents().innerCapture(regExpFormatted(/(.*)\n\n(.*)\n(.*)\n(.*)/));if(T=N[1],f=N[2],C=N[3],S=N[4],ASSERT(f,C,T))return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:i,email:n},totalPrice:p,priceCurrency:s,checkinTime:f,checkoutTime:C,modifyReservationUrl:m,cancelReservationUrl:d,reservationStatus:"http://schema.org/Reservation"+F,reservationId:o,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:T,url:y,telephone:A,address:S}}]}}).call();