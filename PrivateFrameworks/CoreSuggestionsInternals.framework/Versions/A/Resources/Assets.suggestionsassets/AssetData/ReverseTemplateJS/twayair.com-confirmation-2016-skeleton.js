(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,o,p,g,s,l,u,m,h,c,d,C,f,v,D,T,S,y,b,x,A,E,F,N=[],R=[],k="5";for(n=a.getSpan(),r.subjectConfirm.test(e.subject)?k="5":r.subjectChange.test(e.subject)&&(k="4"),y=n.innerCapture(regExpFormatted(/\1\s*:\s*(\w+)/,r.reservationId),1),(b=n.innerCapture(regExpFormatted(/\1\s*([\d,.]+)/,r.pricePrefix),1))&&(x="KRW"),T=n.innerCapture(regExpFormatted(/\1\s*:\s*(\w+)/,r.seatType),1),E=n.next(r.nameSummary).nextTag("table"+k).allInnerTags("tr"+k),A=1;A<E.length;A++)8===(F=E[A].allInnerTags("td"+k)).length&&(i=F[0].tagContents(),S=F[1].tagContents(),i.getLength()&&(i=i.toString().replace(/\n/,""),R.push({name:i,ticketNumber:S})));for(E=n.next(r.flightSummary).nextTag("table"+k).allInnerTags("tr"+k),A=1;A<E.length;A++)6===(F=E[A].allInnerTags("td"+k)).length&&(m=F[0].innerDate().toString(),s=F[1].tagContents().innerCapture(r.airportsRegExp),l=F[2].tagContents().innerCapture(r.timesRegExp),o=F[3].tagContents().innerCapture(r.flightRegExp),s&&5===s.length&&([,c,d,v,D]=s),l&&3===l.length&&([,h,f]=l,u=a.getDetachedSpan(m+" "+h.toString()).innerDate(),C=a.getDetachedSpan(m+" "+f.toString()).innerDate(),Date.parse(a.getDateDD(C).iso8601)<Date.parse(a.getDateDD(u).iso8601)&&(C=modifyDate(C,1))),o&&3===o.length&&([,g,p]=o),ASSERT(g,p,u)&&N.push({departureAirport:c,departureCode:d,arrivalAirport:v,arrivalCode:D,departureDateTime:u,arrivalDateTime:C,airlineCode:g,flightNumber:p}));var z=[];if(N.forEach(function(e){R.forEach(function(t){z.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:t.name},reservationId:y,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:b,priceCurrency:x,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:t.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:T}}})})}),z.length)return z}}).call();