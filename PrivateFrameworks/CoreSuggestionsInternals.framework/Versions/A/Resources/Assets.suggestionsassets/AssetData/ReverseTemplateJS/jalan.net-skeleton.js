(function(){return function(e,t,r){var n,a,i,o,p,s,m,g,c,u,d,h,x,f=Scanner.fromMessage(e);if(f.setLocale(t),r.reservationCancelled.test(e.subject))x="Cancelled";else{if(!r.confirmation.test(e.subject))return CONTINUE;x="Confirmed"}n=f.getSpan().innerCapture(regExpFormatted(/\1.(.*)\2/,r.underPersonNamePrefix,r.underPersonNameSuffix),1).trim(),i=f.getSpan().innerCapture(regExpFormatted(/\1(?::|\uff1a)(.*)/,r.hotelNamePrefix),1).trim(),o=f.getSpan().innerCapture(regExpFormatted(/\1\s*.\s*([\d|\-|\+]+)/,r.hotelPhonePrefix),1).trim(),s=f.getSpan().innerCapture(r.hotelAddressRegExp,1).trim(),m=f.getSpan().innerCapture(regExpFormatted(/\1.(.*)/,r.reservationIdPrefix),1).trim();var C=f.getSpan().innerCapture(r.priceRegExp,1).trim();g=f.getSpan().nextText(r.checkInDateTimePrefix).nextDate();var S=f.getSpan().innerCapture(regExpFormatted(/\1.(.*)\2/,r.stayLengthPrefix,r.stayLengthSuffix),1).trim();return u=f.getSpan().innerCapture(regExpFormatted(/\1\s*(.*)/,r.checkOutTime),1),S.exists()&&S.getLength()>0&&(c=modifyDate(g,int(S.toString())),u&&(c=combineDateAndTime(c,u))),d=C.innerCapture(/([\d,.]+)/,1),h=C.innerCapture(/([^\d,.]+)/,1).trim(),ASSERT(n,i,g)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:n,email:a},totalPrice:d,priceCurrency:h,checkinTime:g,checkoutTime:c,reservationStatus:"http://schema.org/Reservation"+x,reservationId:m,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:i,telephone:o,url:p,address:s}}]:CONTINUE}}).call();