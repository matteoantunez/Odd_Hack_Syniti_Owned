(function(){return function(e,t,n){var a,i,r;if(isDateTimeDuration(n)){var s=t.getDetachedSpan(t.getDateDD(n).endIso8601);if(dateTimeSpanToEpoch(n)<=dateTimeSpanToEpoch(s))return s}var o=t.getSpan().allAbsoluteDates().filter(function(n){return/[\d\uff10-\uff19]{1,2}/.test(n.toString())&&!e.footer.map(function(e){return t.getSpan().next(e)}).filter(function(e){return e.exists()}).some(function(e){return e.contains(n)})});if((r=o.filter(function(e){return isDateDuration(e)&&!hasTime(e)})).length>0){var D=t.getDetachedSpan(t.getDateDD(r[0]).endIso8601).innerDate();if(dateTimeSpanToEpoch(n)<=dateTimeSpanToEpoch(D))return D}if((s=(s=o.shift())&&s.toString().includes(n.toString())&&o.length>0?o.shift():t.getNullSpan())&&s.exists()&&t.getDateDD(s).endIso8601.length>0&&(s=t.getDetachedSpan(t.getDateDD(s).endIso8601).innerDate()),"undefined"!=typeof e.endDate)for(i=0;i<e.endDate.length&&(!a||!a.exists());i++){var f=t.getSpan().next(e.endDate[i]);(a=f.nextAbsoluteDate()).exists()&&a.start_-f.end_<=75&&/[\d\uff10-\uff19]{1,2}/.test(a.toString())&&(s=a)}if("undefined"!=typeof e.skipEndDate)for(i=0;i<e.skipEndDate.length;i+=1)t.getSpan().next(e.skipEndDate[i]).exists()&&(s=s.nextDate());if(s&&s.exists()&&!hasTime(s)){var d;for(i=0;i<e.endTime.length&&(!d||!d.exists());i++)(d=t.getSpan().next(e.endTime[i]).nextDate()).exists()&&hasTime(d)?s=combineDateAndTime(s,d):d=t.getNullSpan();if(!d)for(var u=null!==(o=t.getSpan().withStart(s.getEnd()).allDates().filter(function(e){return/[\d\uff10-\uff19]{1,2}/.test(e.toString())}))?o.length:0,p=0;p<u;p++)if(hasTime(o[p])){s=combineDateAndTime(s,o[p]);break}}return Date.parse(unSpanDate_(n))>=Date.parse(unSpanDate_(s))&&(s=t.getNullSpan()),s}}).call();