(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var n,i,o,p,l=a.getSpan(),s=[],u=[],g=[];if(n=l.innerCapture(regExpFormatted(/\1\s([\dA-Z]+?)\s/,t.reservationId),1),l.next(t.passenger).nextTag("table2").nextTag("table2").allInnerTags("tr2").filter(function(e){return t.passengerCheckRegExp.test(e)}).forEach(function(e){s.push({name:e.allInnerTags("td2")[1].tagContents()})}),l.allInnerTags("table5").filter(function(e){return t.legCheckRegExp.test(e)}).forEach(function(e){var r,t,a,n,i,o=e.allInnerTags("td5"),p=o[2].tagContents().innerCapture(/(.+)(?:\s?([A-Z\d]{2})\s?(\d{2,4}))?/);r=p[1],t=p[2],a=p[3],n=o[1].tagContents().innerCapture(/\((\D{3})\)/,1),i=o[5].tagContents().innerCapture(/\((\D{3})\)/,1);var l=o[0].tagContents().replace(/(\d{2}:\d{2}).+?,\s(\d{1,2}\s.+)/,"$2 $1").innerDate(),s=o[4].tagContents().replace(/(\d{2}:\d{2}).+?,\s(\d{1,2}\s.+)/,"$2 $1").innerDate();u.push({airlineName:r,airlineCode:t,flightNumber:a,departureDateTime:l,departureAirport:null,departureAirportCode:n,arrivalDateTime:s,arrivalAirport:null,arrivalAirportCode:i,seatNumber:null,seatType:o[7].tagContents().innerCapture(/\s-\s(.+)/,1)})}),e.subject.toString().match(t.hotelCheck))l.next(t.legCheckRegExp).parentTag("table2").firstClosingTag("table2").nextTag("table5");return s.forEach(function(e){u.forEach(function(r){r.flightNumber!==a.getNullSpan()&&ASSERT(e.name,r.flightNumber,r.departureAirportCode||r.departureAirport,r.departureDateTime,r.arrivalAirportCode||r.arrivalAirport,r.arrivalDateTime)&&g.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:r.airlineName,airlineCode:r.airlineCode,flightNumber:r.flightNumber,departureAirportFuzzy:r.departureAirport,departureAirportCode:r.departureAirportCode,departureTime:r.departureDateTime,arrivalAirportFuzzy:r.arrivalAirport,arrivalAirportCode:r.arrivalAirportCode,arrivalTime:r.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:e.name},reservationId:n,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:i,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:p,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:r.seatNumber,seatingType:r.seatType}}})})}),g.length>=1?g:CONTINUE}}).call();