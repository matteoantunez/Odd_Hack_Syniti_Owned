(function(){return function(e,t,n){var a,r,g,i,o,s,p,c,x,u,d,C,m,h,l,S,D,T,f=Scanner.fromMessage(e);if(f.setLocale(t),!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;if(!n.reservationId.test(f.getSpan()))return CONTINUE;o=f.getSpan().nextRegExp(n.reservationId).tagContents().innerCapture(n.reservationId,1),a=f.getSpan().nextRegExp(n.guestName).tagContents().innerCapture(n.guestName,1),x=getFuzzyDate(f.getSpan().nextRegExp(n.checkInDate).nextAnyTag("td").tagContents()),C=getFuzzyDate(f.getSpan().nextRegExp(n.checkOutDate).nextAnyTag("td").tagContents()),0!==x.toString().length&&0!==C.toString().length||(c=f.getSpan().nextRegExp(n.checkOutDate).parentAnyTag("td").tagContents().nextDate(),p=f.getSpan().nextRegExp(n.checkOutDate).parentAnyTag("td").tagContents().nextDate().nextDate(),d=f.getSpan().nextRegExp(n.checkOutDate).parentAnyTag("td").tagContents().nextDate().nextDate().nextDate(),u=f.getSpan().nextRegExp(n.checkOutDate).parentAnyTag("td").tagContents().nextDate().nextDate().nextDate().nextDate(),x=getFuzzyDate(f.getDetachedSpan(c+" "+p).innerDate()),C=getFuzzyDate(f.getDetachedSpan(d+" "+u).innerDate()));var y=f.getSpan().nextRegExp(n.priceVersion1).previousTag("td4").tagContents();if(not(y))y=f.getSpan().nextRegExp(n.priceVersion2).previousTag("td3").tagContents();if(g=y.innerCapture(/([\d,.]+)/,1),i=y.innerCapture(/([^\d,.]+)/,1).trim(),h=f.getSpan().nextAnyTag("td").nextAnyTag("td").tagContents(),(S=f.getSpan().nextTag("td3").nextTag("td3").tagContents()).toString().indexOf(n.phone)&&(S=S.split(n.phone)[0].trim()),l=f.getSpan().nextPhoneNumber(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(a,o,x,C,S))return CONTINUE;s="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(!ASSERT(a,o,x,C,S))return CONTINUE;s="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:r},totalPrice:g,priceCurrency:i,checkinTime:x,checkoutTime:C,modifyReservationUrl:D,cancelReservationUrl:T,reservationStatus:"http://schema.org/Reservation"+(s||"Confirmed"),reservationId:o,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:h,url:m,telephone:l,address:S}}]}}).call();