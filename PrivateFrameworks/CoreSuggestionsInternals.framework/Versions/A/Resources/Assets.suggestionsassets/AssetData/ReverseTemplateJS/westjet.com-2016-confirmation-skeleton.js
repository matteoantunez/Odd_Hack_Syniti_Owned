(function(){return function(e,r,t){var a,n,i,p,o,s,l,m,u,d,g=Scanner.fromMessage(e);g.setLocale(r);var h=[],v=[],c=[];a=g.getSpan().next(t.reservationId).nextAnyTag("td").tagContents();var T=g.getSpan().allInnerCapture(/(WS\s(\d{2,}))/,1);for(o=0;o<T.length;o++){(n={}).flightNumber=T[o].innerCapture(/WS\s(\d+)/,1);var C=T[o].nextDate();m=T[o].next(t.departure).nextAnyTag("td").tagContents(),n.departureTime=combineDateAndTime(C,m.innerDate()),n.departureCode=m.innerCapture(/^(\w{2,})\b/,1),m=T[o].next(t.arrival).nextAnyTag("td").tagContents(),n.arrivalTime=combineDateAndTime(C,m.innerDate()),n.arrivalCode=m.innerCapture(/^(\w{2,})\b/,1),Date.parse(n.departureTime)>Date.parse(n.arrivalTime)&&(n.arrivalTime=modifyDate(n.arrivalTime,1));var y=T[o].parentTag("table5").allInnerCapture(t.seat,1);for(n.passengers=[],d=0;d<y.length;d++)(s={}).name=y[d].previousAnyTag("td").tagContents(),s.seat=y[d].nextAnyTag("td").tagContents().innerCapture(/(\d+\w+)/,1),ASSERT(s.name)&&n.passengers.push(s);ASSERT(n.departureCode,n.arrivalCode,n.departureTime,n.arrivalTime,n.flightNumber)&&v.push(n)}for(u="Confirmed",o=0;o<v.length;o++)for(h=(l=v[o]).passengers,d=0;d<h.length;d++){c.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:l.airlineName,airlineCode:"WS",flightNumber:l.flightNumber,departureAirportFuzzy:l.departureAirport,departureAirportCode:l.departureCode,departureTime:l.departureTime,arrivalAirportFuzzy:l.arrivalAirport,arrivalAirportCode:l.arrivalCode,arrivalTime:l.arrivalTime},underName:{"@type":"http://schema.org/Person",name:(s=h[d]).name},checkinUrl:null,reservationId:a,reservationStatus:"http://schema.org/Reservation"+u,totalPrice:i,priceCurrency:p,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:s.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:s.seat}}})}if(c.length)return c}}).call();