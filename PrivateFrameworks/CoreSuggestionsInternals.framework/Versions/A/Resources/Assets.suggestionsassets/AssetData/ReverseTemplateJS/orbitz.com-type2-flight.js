(function(){return function(e,t,r){var n=Scanner.fromMessage(e);n.setLocale(t);var a,i,l,s,o,p,u,d,g,m,c,f,h=n.getSpan(),v=[],A=[];h.next(r.itNum).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+(.*)/,r.itNum),1);i=r.cancelled.test(e.plain)?"cancelled":"confirmed";var x=n.getSpan().next(r.departure).parentAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/[a-zA-Z ]+($<flightNumber>\d+)\s(?:\1.*)?/),T=n.getSpan(),C=h.next(r.departure).nextTag("table7"),b=h.next(r.departure).nextTag("table7").allInnerTagsFiltered("td8");b=b.filter(function(e){return!/Terminal: [\dA-Z]/.test(e.getString())});for(var N=h;!C.isNullSpan_&&0!==b.length;){var $=[];if(b.length<2)b=(b=(C=C.next(r["return"]).nextTag("table7")).allInnerTagsFiltered("td8")).filter(function(e){return!/Terminal: [\dA-Z]/.test(e.getString())});else{if(N.next(r.confirmation).exists()){var y=N.next(r.confirmation).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<confirm>.*)\s*\(.*\)/,r.confirmation));a=y?y.$confirm:null}else a=f;if(N.next(r.ticket).exists())for(var S=N.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$1")}),F=N.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$2")}),D=1;D<S.length;D++)$.push({name:F[D].trim(),ticketNumber:S[D].trim()});else $=A;var k,z=C.previous(r.dateCheck).nextAbsoluteDate();z===c&&k>unSpanDate_(z)&&(z=k),p=(x=b[0].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/))?x.$airlineName:null,u=x?x.$airlineCode:null,o=b[1].innerDate();var Z,I=C.previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<airline>[a-zA-Z ]+)($<flightNumber>\d+)\s?(?:\1.*)?/,r.op));s=I?I.$flightNumber:null,l=I?I.$airline:null,o=combineDateAndTime(z,o),Date.parse(o)<Date.parse(d)&&(z=k=(o=modifyDate(o,1)).split(" ")[0]),g=(x=(x=b[2].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/))||b[3].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/))?x.$airlineName:null,m=x?x.$airlineCode:null,d=b[3].innerDate(),T.exists()&&(Z=(T=T.next(regExpFormatted(/\1\s*:\s*(\w+)/i,r.cabin))).exists()?T.getString().split(":")[1].trim():""),/\d?\d:\d{2}(?:AM|PM)?/i.test(d)||(d=b[4]),/\+\d day/.test(b[3])&&(z=b[3].nextAbsoluteDate(),k=unSpanDate_(z)),(d=combineDateAndTime(z,d))&&v.push({departureAirport:p,departureCode:u,departureTime:o,arrivalTime:d,arrivalAirport:g,flightNumber:s,arrivalCode:m,airlineName:l,cabin:Z,passengers:$,reservationId:a}),c=C.previous(r.dateCheck).nextAbsoluteDate(),b=(b=(C=C.nextTag("table7")).allInnerTagsFiltered("td8")).filter(function(e){return!/Terminal: [\dA-Z]/.test(e.getString())}),N=g,A=$,f=a}}for(var w=[],E=0;E<v.length;E++)for(var M=v[E],_=($=M.passengers,0);_<$.length;_++){var P={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:M.airlineName.trim(),flightNumber:M.flightNumber,departureAirportFuzzy:M.departureAirport,departureAirportCode:M.departureCode,departureTime:M.departureTime,arrivalAirportFuzzy:M.arrivalAirport,arrivalAirportCode:M.arrivalCode,arrivalTime:M.arrivalTime},underName:{"@type":"http://schema.org/Person",name:$[_].name},reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:$[_].ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:M.cabin}},reservationId:M.reservationId.trim(),reservationStatus:"http://schema.org/Reservation"+i};w.push(P)}return w}}).call();