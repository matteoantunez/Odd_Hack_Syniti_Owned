new ReverseTemplateList([new ReverseTemplate("delta.com-forwarded-itinerary-en",function(e){return/^Delta\.com (?:Itinerary|Trip Information) from:/.test(e.subject)},function(e){if(/^Delta\.com (?:Itinerary|Trip Information) from:/.test(e.subject)){var r,t,a,i=Scanner.fromMessage(e);i.setLocale("en_US");var n,o,p,l,m,s,u,g,h,d,c,b,f,v,N,T=[],C={};t=i.getSpan().nextRegExp(/Confirmation Number\s+:/).parentAnyTag("td").tagContents().innerCapture(/Confirmation Number\s+:(.*)/,1),n=i.getSpan().nextText("Who's Coming Along").nextTag("table2").allInnerTagsFiltered("td2").join().split("&");for(var y=0;y<n.length;y++)n[y]=n[y].trim(),C[n[y].toString()]={name:n[y].toString(),seats:{},seatingType:{}};o=i.getSpan().nextText("Our Flights").nextTag("table2").allInnerTags("tr2");var S=/($<airport>.*?) \(($<code>[A-Z]{3})\)/,A=!0;function F(){A?A=!1:ASSERT(c,h,N,f,p)&&(T.push({airlineName:s,airlineCode:u,flightNumber:p,departureTime:h,departureAirport:d,departureCode:c,arrivalTime:f,arrivalAirport:v,arrivalCode:N,passengers:C}),g=d=h=c=b=v=f=N=m=s=u=p=null)}for(y=0;y<o.length;y++)(l=o[y].allInnerTagsFiltered("td2"))[0].innerCapture(/^Flight Number:/)?F():l[0].innerCapture(S)&&l[3]?(g=l[0].innerCapture(S),d=g?g.$airport:null,c=g?g.$code:null,b=l[2].innerCapture(S),v=b?b.$airport:null,N=b?b.$code:null,m=l[3].innerCapture(/($<airlineName>.*)\s+($<flightNumber>\d+)/),"DL"==(s=m?m.$airlineName.trim():null).toString()&&(s=null,u="DL"),p=m?m.$flightNumber:null):l[0].innerCapture(/^Departs/)&&l[1]&&(h=l[0].innerDate(),f=l[1].innerDate());F();var $=[];for(y=0;y<T.length;y++)for(var x=T[y],I=Object.keys(x.passengers),D=0;D<I.length;D++){var k=x.passengers[I[D]],z={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:x.airlineName,airlineCode:x.airlineCode,flightNumber:x.flightNumber,departureAirportFuzzy:x.departureAirport,departureAirportCode:x.departureCode,departureTime:x.departureTime,arrivalAirportFuzzy:x.arrivalAirport,arrivalAirportCode:x.arrivalCode,arrivalTime:x.arrivalTime},underName:{"@type":"http://schema.org/Person",name:k.name},checkinUrl:a,reservationId:t,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:k.totalPrice,priceCurrency:k.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:r,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:k.seats[x.flightNumber],seatingType:k.seatingType[x.flightNumber]}}};valid(k.membershipNumber,k.programName)&&(z.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:k.membershipNumber,programName:k.programName}),$.push(z)}if($.length)return $}},"SG78d718d9")]);