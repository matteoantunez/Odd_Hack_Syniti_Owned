(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,p,o=a.getSpan(),g="Confirmed",l=[],s=[],d=[],u=a.getSpan().next(r.pass).next(/NAME/).parentAnyTag("td").getTagNumber();a.getSpan().next(r.pass).nextTag("table5").allInnerTags("td"+u).forEach(function(e,t){t>2&&t%3==0&&d.push(e.tagContents())}),n=o.next(r.reservationId_prefix).nextAnyTag("td").tagContents();var c=o.next(r.totalPrice_prefix).nextAnyTag("td").tagContents();c=/^(.)(.*)/.exec(c),p=c[1],i=c[2];var T=o.next(r.flightLegs_prefix).nextDate().parentAnyTag("tr").getTagNumber(),m=o.next(r.flightLegs_prefix).nextTag("table"+T).allInnerTags("tr"+T);return m.forEach(function(e,t){var a=e.nextAnyTag("td").tagContents();r.detectNewLeg.test(a)&&l.push(m[t]+m[t+1]+m[t+2]+m[t+5])}),function(e,t){e.forEach(function(e){var r,n,i,p,o,g,l,s,d,u,c,m,h="NK";o=d=(e=a.getDetachedSpan(e)).nextAnyTag("td").tagContents();var A=e.nextAnyTag("tr").allInnerTagsFiltered("td"+T);l=A[0],g=getFuzzyDate(a.getDetachedSpan(o+" "+A[1]).firstDate());var f=e.nextAnyTag("tr").nextAnyTag("tr").allInnerTagsFiltered("td"+T);c=f[0],u=getFuzzyDate(a.getDetachedSpan(d+" "+f[1]).firstDate()),Date.parse(g)>Date.parse(u)&&(u=modifyDate(u,1)),n=e.nextAnyTag("tr").nextAnyTag("tr").nextAnyTag("tr").allInnerTagsFiltered("td"+T)[0],t({airlineName:r,airlineCode:h,flightNumber:n,departureDateTime:g,departureAirport:l,departureAirportCode:s,arrivalDateTime:u,arrivalAirport:c,arrivalAirportCode:m,ticketNumber:i,seatType:p})})}(l,function(e){if(ASSERT(e.flightNumber,e.departureDateTime,e.departureAirport,e.arrivalAirport))for(var t=0;t<d.length;t++)s.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:d[t]},reservationId:n,reservationStatus:"http://schema.org/Reservation"+g,totalPrice:i,priceCurrency:p,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:e.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}}})}),s.length>=1?s:CONTINUE}}).call();