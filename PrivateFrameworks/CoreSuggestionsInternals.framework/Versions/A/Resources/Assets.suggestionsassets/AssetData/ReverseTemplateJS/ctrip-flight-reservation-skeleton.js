(function(){return function(e,r,t){var a,i,n,o,l,p,d,g,s,u,h=Scanner.fromMessage(e),m=h.getSpan();h.setLocale(r),a=m.nextText(t.reservationIdPrefix).parentTag("td1").tagContents().innerCapture(regExpFormatted(/\1(.+)/,t.reservationIdPrefix),1);var c={},v=[],T=m.nextText(t.itineraryHeader).nextTag("table1").allInnerTagsFiltered("tr1");T.shift(),T.shift();for(var f=0;f<T.length;f++){c={};T[f].allInnerTagsFiltered("td1").toString();[,p,o,g,u,d,s]=T[f].allInnerTagsFiltered("td1").toString().match(/([0-9A-Z]{2})(\d+),(.+?),(.+?),(.+?),(.+?),/),c.airlineCode=p,c.flightNumber=o,c.departureAirport=g,c.arrivalAirport=u,c.departureTime=getFuzzyDate(h.getDetachedSpan(d.toString())),c.arrivalTime=getFuzzyDate(h.getDetachedSpan(s.toString())),ASSERT(c.departureAirport,c.arrivalAirport,c.departureTime,c.arrivalTime,c.airlineCode,c.flightNumber)&&v.push(c)}var C=[],x=m.nextText(t.itineraryHeader).nextTag("table1").nextTag("table1").allInnerTagsFiltered("tr1");for(x.shift(),f=0;f<x.length;f++)c={},[,n]=x[f].innerCapture(/(.+)\s\s\s\[\/td1\](\s?)\[td1\]/),c.name=n,C.push(c);var y=(l=m.nextText(t.totalCostPrefix).parentTag("td1").tagContents().innerCapture(regExpFormatted(/\1(.+)\n/,t.totalCostPrefix),1)).innerCapture(/([\d,.-]+)/,1),F=l.innerCapture(/([^\d,.-\w]+)/,1).trim();null!==F&&0!==F.toString().length||(F=l.innerCapture(/([^\d,.-]+)/,1).trim());var S=[];for(f=0;f<v.length;f++)for(var A=v[f],b=0;b<C.length;b++){var z=C[b];S.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:A.airlineName,airlineCode:A.airlineCode,flightNumber:A.flightNumber,departureAirportFuzzy:A.departureAirport,departureAirportCode:A.departureCode,departureTime:A.departureTime,arrivalAirportFuzzy:A.arrivalAirport,arrivalAirportCode:A.arrivalCode,arrivalTime:A.arrivalTime},underName:{"@type":"http://schema.org/Person",name:z.name},checkinUrl:i,reservationId:a,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:z.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}},totalPrice:y,priceCurrency:F,reservationStatus:"http://schema.org/ReservationConfirmed"})}if(S.length)return S}}).call();