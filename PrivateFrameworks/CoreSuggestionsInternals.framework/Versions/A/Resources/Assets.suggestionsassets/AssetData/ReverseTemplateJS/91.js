new ReverseTemplateList([new ReverseTemplate("canadiannorth-flight-confirmation-en",function(e){return/^Canadian North Electronic Ticket Receipt/.test(e.subject)},function(e){if(/^Canadian North Electronic Ticket Receipt/.test(e.subject)){var t=Scanner.fromMessage(e);t.setLocale("en_CA");var r,a,n,i,o,s,p,g,l,c,u,d,m,h,T,C,v,x,f,b,k=t.getSpan(),S=[],y={};for(a=k.nextText("Booking reference/Record locator").nextTag("td4").tagContents().trim(),(o=k.nextText("Your ticket(s) number(s) is/are:").parentTag("td3").tagContents().innerCapture(regExpFormatted(/\1([\w\s\W]+)/,"Your ticket(s) number(s) is/are:"),1).split(/\n/)).shift(),f=0;f<o.length;f++)[,i,r]=o[f].innerCapture(/(.+):\s(\d+)\s</),y[i.toString()]={name:i.trim(),ticketNumber:r.trim(),seats:{}};for(g=k.withInterval(k.nextText("Booking reference/Record locator").getEnd(),k.nextText("Your ticket(s) number(s) is/are:").getStart()).allInnerTagsFiltered("table5"),f=0;f<g.length;f++){[,c,u,l]=g[f].innerCapture(/(.+)\sFlight Number\s([A-Z0-9]+)\s(\d+)\s/);var A=g[f].allInnerTagsFiltered("table6");[,h,m]=A[0].innerText("Departure:").nextTag("td6").tagContents().innerCapture(/(.+?)\s(.+)\n/),d=A[0].innerText("Departure:").nextTag("td6").tagContents().innerDate(),[,v,C]=A[0].innerText("Arrival:").nextTag("td6").tagContents().innerCapture(/(.+?)\s(.+)\n/),T=A[0].innerText("Arrival:").nextTag("td6").tagContents().innerDate(),p=A[2].split("/td6"),s="";for(b=0;b<p.length;b++){var N=p[b];i=N.innerText("Seat(s):").previousTag("td7").tagContents(),/Check-In Required/.test(N)||([,s]=N.innerText("Seat(s):").nextTag("td7").tagContents().innerCapture(/(.+)\s\//));for(var F=Object.keys(y),R=0;R<F.length;R++){if(0===y[F[R]].name.toString().localeCompare(i.toString())){y[F[R]].seats[d.toString()]=s;break}}}ASSERT(l,d,T)&&S.push({airlineCode:u,flightNumber:l,departureTime:d,departureCode:h,departureAirport:m.trim(),arrivalTime:T,arrivalCode:v,arrivalAirport:C.trim(),passengers:y})}var z=[];for(f=0;f<S.length;f++){var E=S[f],I=Object.keys(E.passengers);for(b=0;b<I.length;b++){var j={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:E.airlineName,airlineCode:E.airlineCode,flightNumber:E.flightNumber,departureAirportFuzzy:E.departureAirport,departureAirportCode:E.departureCode,departureTime:E.departureTime,arrivalAirportFuzzy:E.arrivalAirport,arrivalAirportCode:E.arrivalCode,arrivalTime:E.arrivalTime},underName:{"@type":"http://schema.org/Person",name:(x=E.passengers[I[b]]).name},checkinUrl:n,reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:x.totalPrice,priceCurrency:x.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:x.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:x.seats[E.departureTime.toString()],seatingType:""}}};z.push(j)}}if(z.length)return z}},"SG700026b6")]);