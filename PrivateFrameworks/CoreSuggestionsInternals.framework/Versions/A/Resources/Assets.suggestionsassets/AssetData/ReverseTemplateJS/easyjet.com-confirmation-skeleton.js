(function(){return function(e,r,t){var a,n,i,p,o,s,l,u,g,d,m,v,h,c=Scanner.fromMessage(e);c.setLocale(r);var x=[],y=[],A=[],C="easyjet",f="U2";m=regExpFormatted(/\1\s*(.*)/,t.reservationId).exec(e.subject)[1],i=c.getSpan().next(t.itinerary),g=(u=c.getSpan().next(t.payment).nextAnyTag("table").nextAnyTag("td").nextAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*(.*)\s\2\s/,t.paymentPreFix,t.paymentPostFix),1)).innerCapture(/([\d,.]+)/,1),d=u.innerCapture(/([^\d,.]+)/,1).trim(),a=i.next(t.passengers).parentAnyTag("table").allInnerTags("td5");for(var T=1;T<a.length;T++)(n={}).name=a[T].tagContents(),y.push(n);for(o=i.next(t.arrival);o.exists();)s={},l=(p=o.previous(t.departure)).previousAnyTag("td").previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<departure>[\w\s\xe1]+)\s(?:\(.*\)\s)?\1\s($<arrival>[^\(]+?)(?:$|\()/,t.arrivalAirport)),s.departureAirport=l.$departure.trim(),s.arrivalAirport=l.$arrival.toString().replace("(Flexible)","").trim(),s.departureDate=p.nextDate(),s.arrivalDate=o.nextDate(),s.flightNumber=o.next(t.flight).parentAnyTag("td").tagContents().innerCapture(/(\d+)/,1),s.seats=o.next(t.seat).nextAnyTag("td").tagContents().toString().split(", "),o=o.next(t.arrival),ASSERT(s.flightNumber,s.departureDate,s.departureAirport,s.arrivalDate,s.arrivalAirport),A.push(s);for(h=0;h<A.length;h++){s=A[h];for(var F=0;F<y.length;F++){x.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:C,airlineCode:f,flightNumber:s.flightNumber,departureAirportFuzzy:s.departureAirport,departureAirportCode:s.departureAirportCode,departureTime:s.departureDate,arrivalAirportFuzzy:s.arrivalAirport,arrivalAirportCode:s.arrivalAirportCode,arrivalTime:s.arrivalDate},underName:{"@type":"http://schema.org/Person",name:(n=y[F]).name},reservationId:m,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:g,priceCurrency:d,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:v,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:s.seats[F]}}})}}if(x.length)return x}}).call();