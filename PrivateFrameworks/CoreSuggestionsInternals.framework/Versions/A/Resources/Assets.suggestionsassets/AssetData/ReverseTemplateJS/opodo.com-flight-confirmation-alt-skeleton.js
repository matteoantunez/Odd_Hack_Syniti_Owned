(function(){return function(e,r,t){e.plain=e.plain.replace(/(\d{1,2}) mrt/g,"$1 mar");var a=Scanner.fromMessage(e);a.setLocale(r);for(var n=a.getSpan().next(t.travelHeader).nextTag("table3").allInnerTags("tr3"),i=[],o=0;o<n.length;o++)for(var p=n[o].allInnerTags("table5"),l=0;l<p.length;l++)p[l].toString().match(t.flightCheck)&&i.push(p[l]);var g=[];for(l=0;l<i.length;l++){var s=i[l].allInnerTags("td5"),h=s[0].tagContents().innerDate();h.toString().length<7&&(h=combineDateAndTime(h.nextDate(),h));var d=s[1].tagContents().innerCapture(/($<departureAirportName>.+)\s?\(($<departureAirportCode>.+?)\)/),m=d.$departureAirportName.trim(),u=d.$departureAirportCode,v=s[2].tagContents().innerCapture(/($<airline>.+?)\s?\n?($<airlineCode>[A-Z]{2})\s($<flightNum>\d+)/),C=v.$airline,c=v.$airlineCode,T=v.$flightNum,A=s[4].tagContents().innerDate();A.toString().length<7&&(A=combineDateAndTime(A.nextDate(),A));var N=s[5].tagContents().innerCapture(/($<arrivalAirportName>.+)\s?\(($<arrivalAirportCode>.+?)\)/),f=N.$arrivalAirportName.trim(),x=N.$arrivalAirportCode,k=s[7].tagContents().innerCapture(/\-\s(.+)/,1);ASSERT(m,f,h,A)&&g.push({departureDate:h,arrivalDate:A,arrivalAirportCode:x,departureAirportCode:u,departureAirport:m,arrivalAirport:f,airlineName:C,airlineCode:c,flightNumber:T,seatingType:k})}t.reservationCheck=new RegExp(t.reservationCheck+"|"+g[0].airlineName);var S=[],$=a.getSpan().next(t.reservationIdPrefix).nextTag("table3"),b=$.innerRegExp(t.reservationCheck);for(o=0;o<g.length;o++){(l=o+1)===g.length&&(l=g.length-1),t.reservationCheck=t.reservationCheck.toString().replace(/\//g,""),t.reservationCheck=new RegExp(t.reservationCheck+"|"+g[l].airlineName);var y=b.nextRegExp(/[A-Z0-9]{6}/);(0===y.toString().length||y.parentAnyTag("td").tagContents().toString().length>6)&&(y=S[o-1]),S.push(y),b=$.innerText(y).nextRegExp(t.reservationCheck)}var D,E,F,I=a.getSpan().nextText(t.passengerNamePrefix).nextText(t.passengerHeader).nextTag("table2"),R=I.allInnerTags("tr2"),z=[];if(I.toString().match(/ETKT/))for(o=0;o<R.length/2;o++)E=(D=R[2*o].allInnerTagsFiltered("td2"))[0],F=R[2*o+1].innerCapture(/ETKT\s([\d ]+)/,1),z.push({passengerName:E,ticketNumber:F});else for(o=0;o<R.length;o++)D=R[o].allInnerTagsFiltered("td2"),z.push({passengerName:E=D[0],ticketNumber:F});var P=[];for(o=0;o<g.length;o++){var w=g[o];for(l=0;l<z.length;l++){var H=z[l];P.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:w.airlineName,airlineCode:w.airlineCode,flightNumber:w.flightNumber,departureAirportFuzzy:w.departureAirport,departureTime:w.departureDate,departureAirportCode:w.departureAirportCode,arrivalAirportFuzzy:w.arrivalAirport,arrivalTime:w.arrivalDate,arrivalAirportCode:w.arrivalAirportCode},underName:{"@type":"http://schema.org/Person",name:H.passengerName},reservationId:S[o],reservationStatus:"http://schema.org/ReservationConfirmed",reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:H.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:w.seatingType}}})}}if(P.length)return P}}).call();