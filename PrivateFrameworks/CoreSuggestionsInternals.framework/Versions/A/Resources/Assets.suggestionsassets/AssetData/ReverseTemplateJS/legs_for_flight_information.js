(function(){return function(e,a,r,i){var t=a[a.length-1];t&&t.arrivalPublishedTime&&t.departurePublishedTime.split("T")[0]===e.departureDate&&(t.arrivalPublishedTime.split("T")[0]>e.departureDate&&(e.departureDate=modifyDate(e.departureDate,1)));var l=loadHelper("flight_information.js")(e),d=[];if(!l)return CONTINUE;var u=loadHelper("legs_candidates_for_date.js")(l,e.departureDate);if(!(u instanceof Array&&u.length>0))throw new RT.FlightException(0,"Core: Can't find a leg with the associated departure date");var s=!1;if("object"==typeof u[0].departureAirport&&(s="AAA"===u[0].departureAirport.code),s)d.push(u[0]);else d=loadHelper("best_legs_for_leg_candidates.js")(u,e.departureDate,a,e.span),d=loadHelper("one_or_multiple_legs_for_best_legs.js")(d,e.span,r,i);return d[0]&&e.departureDate.split("T")[0]<d[0].departurePublishedTime.split("T")[0]&&(d[0].departureActualTime=modifyDate(d[0].departureActualTime,-1),d[0].departurePublishedTime=modifyDate(d[0].departurePublishedTime,-1),d[0].arrivalPublishedTime=modifyDate(d[0].arrivalPublishedTime,-1),d[0].arrivalActualTime=modifyDate(d[0].arrivalActualTime,-1),d[0]&&d[0].arrivalPublishedTime.split("T")[0]<d[0].departurePublishedTime.split("T")[0]&&(d[0].arrivalPublishedTime=modifyDate(d[0].arrivalPublishedTime,1),d[0].arrivalActualTime=modifyDate(d[0].arrivalActualTime,1))),d=loadHelper("codeshare_dedup.js")(d,a)}}).call();