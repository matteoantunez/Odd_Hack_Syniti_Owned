(function(){return function(e,t,n){var a,r,i,o,g,s,p,x,l,m,c,d,C,u,h=Scanner.fromMessage(e);if(h.setLocale(t),!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;g=h.getSpan().nextRegExp(n.reservationId).nextAnyTag("td").tagContents(),a=h.getSpan().nextRegExp(n.guestName).nextAnyTag("td").tagContents(),r=h.getSpan().nextRegExp(n.guestEmail).nextAnyTag("td").tagContents(),m=h.getSpan().nextRegExp(n.hotelName).nextAnyTag("td").tagContents().innerCapture(regExpFormatted(/\>\s(.+)\s</),1),l=h.getSpan().nextRegExp(n.hotelName).nextAnyTag("td").tagContents().innerCapture(/(http.+)\>/,1).toString();var T=h.getSpan().nextText(n.dates).nextAnyTag("td").tagContents();p=T.innerDate(),x=T.innerCapture(/(.+) . (.+)/,2),x=h.getDetachedSpan(x+" ").innerDate();var S=h.getSpan().nextRegExp(n.price).nextAnyTag("td").tagContents();if(i=S.innerCapture(/([\d,.]+)/,1),o=S.innerCapture(/([^\d,.]+)/,1).trim(),d=h.getSpan().nextRegExp(n.hotelAddress).nextRegExp(n.hotelAddress).nextAnyTag("td").tagContents(),c=h.getSpan().nextRegExp(n.hotelPhone).tagContents().innerCapture(n.hotelPhone,1),C=u=h.getSpan().nextText(n.modifyUrl).tagContents().nextLink(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(a,g,p,x,d))return CONTINUE;s="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(!ASSERT(a,p,x,d))return CONTINUE;s="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:r},totalPrice:i,priceCurrency:o,checkinTime:p,checkoutTime:x,modifyReservationUrl:C,cancelReservationUrl:u,reservationStatus:"http://schema.org/Reservation"+(s||"Confirmed"),reservationId:g,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:m,url:l,telephone:c,address:d}}]}}).call();