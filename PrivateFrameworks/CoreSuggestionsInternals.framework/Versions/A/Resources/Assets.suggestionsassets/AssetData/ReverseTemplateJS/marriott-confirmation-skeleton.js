(function(){return function(e,t,n){if(!e||!t||!n)return CONTINUE;var r,a,i,o,g,p,x,d,s,c,h,m=Scanner.fromMessage(e);if(m.setLocale(t),"html"===n.version)o=m.getSpan().innerCapture(regExpFormatted(/\1 (\d+)/,n.confirmationNumber),1),p=getFuzzyDate(m.getSpan().nextText(n.checkin).withEnd(m.getSpan().nextText(n.checkout).getStart())),x=getFuzzyDate(m.getSpan().nextText(n.checkout).withEnd(m.getSpan().nextText(n.checkout).parentAnyTag("td").getEnd())),m.getSpan().nextText(n.modifyReservationUrl).nextLink(),d=m.getSpan().nextText(n.hotelUrl).nextLink(),s=(g=m.getSpan().nextText(n.reservationDetails).withEnd(m.getSpan().nextText(n.summary).getStart())).innerCapture(regExpFormatted(/\1 (.*)\s/,n.hotelName),1),r=g.innerCapture(regExpFormatted(/\1 (.*)\s/,n.name),1),a=m.getSpan().nextText(n.totalPrice).nextTag("td1").tagContents(),i=m.getSpan().innerCapture(regExpFormatted(/\1 \(([A-Z]{2,3})/,n.priceCurrency),1),c=(g=m.getSpan().withEnd(m.getSpan().nextTag("table1").getStart())).innerCapture(regExpFormatted(/\1 (.+?) \2/,n.phone,n.fax),1),valid(s,c,g)&&(h=g.withStart(s.getLength()).withEnd(g.innerText(n.phone).getStart()).trim(),g.innerAddress().getLength()>=h.getLength()&&(h=g.innerAddress()));else if("txt"===n.version&&(g=m.getSpan().nextText(n.reservationDetails).withEnd(m.getSpan().nextText(n.planningYourTrip).getStart()),valid(g))){o=g.innerCapture(regExpFormatted(/\1 (\d+)\n/,n.confirmationNumber),1),p=m.getSpan().next(n.checkin).nextDate(),x=m.getSpan().next(n.checkout).nextDate(),r=g.innerCapture(regExpFormatted(/\1 (.*)\n/,n.guestName),1).trim();var u=m.getSpan().innerCapture(regExpFormatted(/^($<name>.*)\n($<address>[^]+)\n\1 ($<phone>.*)\n/,n.phone));u&&(s=u.$name,h=u.$address,c=u.$phone),d=m.getSpan().nextText(n.hotelUrl).nextLink(),g.innerText(n.modifyUrl).nextLink(),a=g.innerCapture(regExpFormatted(/\1 .* - ([\d,.]+)/,n.totalPrice),1),i=g.innerCapture(regExpFormatted(/\1 \(([A-Z]{3})\)/,n.priceCurrency),1)}return ASSERT(p,x,h)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r},totalPrice:a,priceCurrency:i,checkinTime:p,checkoutTime:x,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:o,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:s,url:d,telephone:c,address:h}}]:void 0}}).call();