(function(){return function(e,t,r){var n=Scanner.fromMessage(e);n.setLocale(t);var a,i,l,s,o,p,d,g,u,m,c,f,h=n.getSpan(),v=[],T=[],x=h.next(r.dates).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<firstDate>.*)(?:\s-\s($<secondDate>.*))?/,r.dates)),A=x?x.$firstDate:null;h.next(r.itNum).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+(.*)/,r.itNum),1);i=r.cancelled.test(e.plain)?"cancelled":"confirmed",x=n.getSpan().next(r.departure).parentAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/[a-zA-Z ]+($<flightNumber>\d+)\s(?:\1.*)?/);var C=n.getSpan(),N=h.next(r.departure).nextTag("table7"),$=h.next(r.departure).nextTag("table7").allInnerTagsFiltered("td8");$=$.filter(function(e){return!/Terminal: [\dA-Z]/.test(e.getString())});for(var b=h;!N.isNullSpan_&&0!==$.length;){var S=[];if($.length<2)$=($=(N=N.next(r["return"]).nextTag("table7")).allInnerTagsFiltered("td8")).filter(function(e){return!/Terminal: [\dA-Z]/.test(e.getString())});else{if(b.next(r.confirmation).exists()){var y=b.next(r.confirmation).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<confirm>.*)\s*\(($<airlineName>.*)\)/,r.confirmation));a=y?y.$confirm:null,l=y?y.$airlineName:null}else a=c,l=f;if(b.next(r.ticket).exists())for(var F=b.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$1")}),z=b.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$2")}),k=1;k<F.length;k++)S.push({name:z[k].trim(),ticketNumber:F[k].trim()});else S=T;p=(x=$[0].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/))?x.$airlineName:null,d=x?x.$airlineCode:null,o=$[1];var Z,D=N.previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/[a-zA-Z ]+($<flightNumber>\d+)\s?(?:\1.*)?/,r.op));s=D?D.$flightNumber:null,o=combineDateAndTime(n.getDetachedSpan(A.toString()),o),u=(x=(x=$[2].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/))||$[3].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/))?x.$airlineName:null,m=x?x.$airlineCode:null,g=$[3],C.exists()&&(Z=(C=C.next(regExpFormatted(/\1\s*:\s*(\w+)/i,r.cabin))).exists()?C.getString().split(":")[1].trim():""),/\d?\d:\d{2}(?:AM|PM)?/i.test(g)||(g=$[4]),(g=combineDateAndTime(n.getDetachedSpan(A.toString()),g))&&v.push({departureAirport:p,departureCode:d,departureTime:o,arrivalTime:g,arrivalAirport:u,flightNumber:s,arrivalCode:m,airlineName:l,cabin:Z,passengers:S,reservationId:a}),$=($=(N=N.nextTag("table7")).allInnerTagsFiltered("td8")).filter(function(e){return!/Terminal: [\dA-Z]/.test(e.getString())}),b=u,T=S,c=a,f=l}}for(var I=[],E=0;E<v.length;E++)for(var w=v[E],M=(S=w.passengers,0);M<S.length;M++){var P={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:w.airlineName,flightNumber:w.flightNumber,departureAirportFuzzy:w.departureAirport,departureAirportCode:w.departureCode,departureTime:w.departureTime,arrivalAirportFuzzy:w.arrivalAirport,arrivalAirportCode:w.arrivalCode,arrivalTime:w.arrivalTime},underName:{"@type":"http://schema.org/Person",name:S[M].name},reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:S[M].ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:w.cabin}},reservationId:w.reservationId.trim(),reservationStatus:"http://schema.org/Reservation"+i};I.push(P)}return I}}).call();