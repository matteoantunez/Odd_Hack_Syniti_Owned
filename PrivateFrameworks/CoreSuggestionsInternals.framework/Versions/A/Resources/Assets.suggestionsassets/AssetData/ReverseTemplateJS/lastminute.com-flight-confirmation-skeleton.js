(function(){return function(e,t,a){var r=Scanner.fromMessage(e);r.setLocale(t);var n,i,g,p=r.getSpan().nextText(a.passengerDetailsHeader).nextTag("table6").nextTag("td6").tagContents().innerCapture(regExpFormatted(/\1\n(.+)/,a.passengerNamePrefix),1),o=r.getSpan().nextText(a.reservationIdPrefix).parentTag("td6").tagContents().innerCapture(regExpFormatted(/\1 (.+)/,a.reservationIdPrefix),1),x=[],d=[],l=r.getSpan().nextText(a.reservationIdPrefix).nextTag("table4").tagContents().split(a.terminal);l.pop();for(var T=0;T<l.length;T++){var s,m,u,c,C,b={},h="",v="";b.departureDate=l[T].nextTag("table5").nextTag("td5").innerDate(),""===b.departureDate.toString()&&(b.departureDate=l[T].nextTag("table5").nextTag("table5").nextTag("table5").nextTag("td5").innerDate()),[h,v]=l[T].nextTag("table5").nextTag("td5").nextTag("td5").tagContents().split("-"),v===undefined&&([h,v]=l[T].nextTag("table5").nextTag("table5").nextTag("table5").nextTag("td5").nextTag("td5").tagContents().split("-")),h=getFuzzyDate(r.getDetachedSpan(h.toString())),v=getFuzzyDate(r.getDetachedSpan(v.toString())),h=combineDateAndTime(b.departureDate,h),v=combineDateAndTime(b.departureDate,v),b.departureTime=h,b.arrivalTime=v;var S,f=/(.+) (\w{2})([1-9]+)/;f.test(l[T].nextTag("table5").nextTag("table5").nextTag("td5").tagContents())?[,u,C,c]=l[T].nextTag("table5").nextTag("table5").nextTag("td5").tagContents().toString().match(/(.+) (\w{2})([1-9]+)/):[,u,C,c]=l[T].nextTag("table5").nextTag("table5").nextTag("table5").nextTag("table5").nextTag("td5").tagContents().toString().match(/(.+) (\w{2})([1-9]+)/),b.airlineName=u,b.airlineCode=C,b.flightNumber=c,0===t.toString().localeCompare("es_ES")?(S="a",f=/a/):0===t.toString().localeCompare("en_US")&&(S="to",f=/to/),f.test(l[T].nextTag("table5").nextTag("table5").nextTag("td5").nextTag("td5").tagContents())?[,s,m]=l[T].nextTag("table5").nextTag("table5").nextTag("td5").nextTag("td5").tagContents().innerCapture(regExpFormatted(/(.+)\s\1(.+)/,S)):[,s,m]=l[T].nextTag("table5").nextTag("table5").nextTag("table5").nextTag("table5").nextTag("td5").nextTag("td5").tagContents().innerCapture(regExpFormatted(/(.+)\s\1(.+)/,S)),b.departureAirport=s.trim(),b.arrivalAirport=m.trim(),ASSERT(b.airlineCode,b.flightNumber,b.departureTime,b.departureAirport,b.arrivalTime,b.arrivalAirport)&&x.push(b)}for(0===t.toString().localeCompare("es_ES")?(i=(n=r.getSpan().nextText(a.pricePrefix).parentTag("td5").tagContents().innerCapture(regExpFormatted(/\1($<price>[\d,\. ]+)($<currency>[^\d,\. ]+)/,a.pricePrefix))).$price,g=n.$currency):(i=(n=r.getSpan().nextText(a.pricePrefix).parentTag("td5").tagContents().innerCapture(regExpFormatted(/\1(.+)/,a.pricePrefix),1)).innerCapture(/([\d,.-]+)/,1),g=n.innerCapture(/([^\d,.-]+)/,1).trim()),T=0;T<x.length;T++){var A=x[T];d.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:A.airlineName,airlineCode:A.airlineCode,flightNumber:A.flightNumber,departureAirportFuzzy:A.departureAirport,departureAirportCode:A.departureAirportCode,departureTime:A.departureTime,arrivalAirportFuzzy:A.arrivalAirport,arrivalAirportCode:"",arrivalTime:A.arrivalTime},underName:{"@type":"http://schema.org/Person",name:p},reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:i,priceCurrency:g,reservedTicket:{"@type":"http://schema.org/Ticket",ticketedSeat:{"@type":"http://schema.org/Seat"}}})}return d}}).call();