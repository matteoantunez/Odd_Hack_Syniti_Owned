(function(){return function(e,r,t){if(!e||!r||!t)return CONTINUE;var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,o,p,s,l,u,d,c,g,m,h,v,f,T,C,y,x,D,A,S=a.getSpan(),b=[],F={};n=S.withInterval(S.nextText(t.reservationId).getEnd(),S.nextText(t.reservationIdPostFix).getStart()).trim();var I=[];for(I=S.nextText(t.passengerDetails).nextTag("table3").allInnerTagsFiltered("td3").filter(function(e){return/Mrs?|Se\xf1ora?|Miss|Dr/.test(e)}),d=(u=S.nextText(t.totalPrice).nextTag("td3").tagContents().innerCapture(/($<priceCurrency>[\w]+)\s($<totalPrice>[\d,.]+)/))?u.$totalPrice:null,c=u?u.$priceCurrency:null,N=0;N<I.length;N++)F[(p=I[N].toString()).toString()]={name:p,totalPrice:d,priceCurrency:c};s=S.withInterval(S.nextText(t.flightDetails).getEnd(),S.nextText(t.endOfFlightDetails).getStart()).allInnerTagsFiltered("table3");for(var N=0;N<s.length;N++){for(var P=s[N].firstAbsoluteDate(),k=s[N].allInnerTagsFiltered("td3"),z=[],E=0,M=0;M<k.length;M++)/Class:|Equipment:|Equipo:/.test(k[M])&&z.push(M);var $=[],w=[];for(M=5;M<z[E];M++)$.push(k[M]),M+1===z[E]&&(M=z[E],E+=1,w.push($),$=[]);for(M=0;M<w.length;M++){var O=w[M].filter(function(e){return!/(?:operado por|operated by)/i.test(e)});[,g,l]=O[0].innerCapture(/([A-Z0-9]+)\s(\d+)/),[,m,h]=O[1].innerCapture(/(.+)\n(.+)/),[,f,T]=O[2].innerCapture(/(.+)\n(.+)/),A=combineDateAndTime(P,m),Date.parse(unSpanDate_(D))>Date.parse(unSpanDate_(A))&&(A=modifyDate(A,1),P=modifyDate(P,1)),D=combineDateAndTime(P,f),Date.parse(A)>Date.parse(D)&&(D=modifyDate(D,1)),ASSERT(l,m,f)&&b.push({airlineCode:g,flightNumber:l,departureTime:A,departureCode:v,departureAirport:h.trim(),arrivalTime:D,arrivalCode:C,arrivalAirport:T.trim(),passengers:F})}}var R=[];for(N=0;N<b.length;N++){var q=b[N],U=Object.keys(q.passengers);for(x=0;x<U.length;x++){R.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Copa Airlines",airlineCode:"CM",flightNumber:q.flightNumber,departureAirportFuzzy:q.departureAirport,departureAirportCode:q.departureCode,departureTime:q.departureTime,arrivalAirportFuzzy:q.arrivalAirport,arrivalAirportCode:q.arrivalCode,arrivalTime:q.arrivalTime},underName:{"@type":"http://schema.org/Person",name:(y=q.passengers[U[x]]).name},checkinUrl:o,reservationId:n,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:y.totalPrice,priceCurrency:y.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}}})}}return R.length?R:void 0}}).call();