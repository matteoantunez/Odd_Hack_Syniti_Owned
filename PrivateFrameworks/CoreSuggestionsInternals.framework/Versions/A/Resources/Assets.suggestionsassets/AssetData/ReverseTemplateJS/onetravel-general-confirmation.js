(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var n=a.getSpan(),i=n.next(t.bookingId).parentAnyTag("td").innerCapture(regExpFormatted(/\1\s(\d+)/,t.bookingId),1),o=[],p=[];if(t.flightCheck){var d=function(e){var r=0;if(e.toString())for(var a=e.allInnerTags("table5"),n=(a.length+1)/4,i=(r=[],0);i<n;i++){var p=a[4*i].innerCapture(regExpFormatted(/($<airlineName>[A-Za-z\s]+?)\n\1($<flightNumber>.+)/,t.flight)),d={};d.airlineName=p.$airlineName.trim(),d.flightNumber=p.$flightNumber.innerCapture(/\d+/,0);var m=a[1+4*i].allInnerTagsFiltered("td5"),s=m[0].innerDate();s.toString()||(s=e.firstDate(),r=1),d.departureAirport=m[1-r];var g=m[2-r].innerCapture(/($<departureAirportCode>[A-Z]+?)\s-\s($<departureTime>.+)/);d.departureAirportCode=g.$departureAirportCode,d.departureTime=combineDateAndTime(s,g.$departureTime);var l=m[5-r]?m[5-r].innerDate():s;d.arrivalAirport=m[3-r];var h=m[4-r].innerCapture(/($<arrivalAirportCode>[A-Z]+?)\s-\s($<arrivalTime>.+)/);d.arrivalAirportCode=h.$arrivalAirportCode,d.arrivalTime=combineDateAndTime(l,h.$arrivalTime),Date.parse(d.departureTime>d.arrivalTime)&&(d.arrivalTime=modifyDate(d.arrivalTime,1)),ASSERT(d.airlineName,d.flightNumber,d.departureAirport,d.departureAirportCode,d.departureTime,d.arrivalAirport,d.arrivalAirportCode,d.arrivalTime)&&o.push(d)}};if(d(n.next(t.departure).parentAnyTag("table")),!n.next(t.which).next(t["return"]).parentAnyTag("table").isNullSpan_)d(n.next(t.which).next(t["return"]).parentAnyTag("table"));for(var m=[],s=a.getDetachedSpan(n.next(t.traveler).parentAnyTag("table").allInnerTags("td4").toString()).first(/Female|Male/i);!s.isNullSpan_;)m.push({name:s.parentAnyTag("td").previousAnyTag("td").previousAnyTag("td").tagContents()}),s=s.nextAnyTag("td").next(/Female|Male/i);for(var g=0;g<o.length;g++)for(var l=o[g],h=0;h<m.length;h++){p.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:l.airlineName,flightNumber:l.flightNumber,departureAirportFuzzy:l.departureAirport,departureAirportCode:l.departureAirportCode,departureTime:l.departureTime,arrivalAirportFuzzy:l.arrivalAirport,arrivalAirportCode:l.arrivalAirportCode,arrivalTime:l.arrivalTime},underName:{"@type":"http://schema.org/Person",name:m[h].name},reservationId:i,reservationStatus:"http://schema.org/ReservationConfirmed"})}}if(t.hotelCheck){var u=n.next(t.which),v=u.nextAnyTag("table").allInnerTagsFiltered("td4")[0],c=u.nextAddress(),A=u.nextDate(),T=u.nextDate().nextDate(),x=u.nextPhoneNumber();ASSERT(c,A)&&p.push({"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:v},checkinTime:A,checkoutTime:T,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:i,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:v,telephone:x,address:c}})}if(t.carCheck){var y=n.next(t.which).nextAnyTag("table"),f=y.nextDate(),C=f.nextAnyTag("td").tagContents(),S=C.split("\n");C=S[0].trim();var b="",N="",F=function(e){for(var r=e[1].trim(),t=2;t<e.length;t++)r+=e[t].trim();return r};b=a.getDetachedSpan(F(S).toString());var $=f.nextDate(),D=$.nextAnyTag("td").tagContents(),R=D.split("\n");D=R[0].trim(),N=a.getDetachedSpan(F(R).toString());var k=y.next(t.econ).next(t.econ).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+(.*)/,t.econ),1),z=y.next(t.driver).nextAnyTag("td").nextAnyTag("td").nextAnyTag("td").tagContents(),I=y.nextPhoneNumber().parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<provider>[^\n]+)?\s*[\n]*?\1\s($<phone>.*)/,t.phone)),E=I?I.$provider:null,P=I?I.$phone:null;ASSERT(z,f,$,C)&&p.push({"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",reservationId:i,reservationStatus:"http://schema.org/ReservationConfirmed",underName:{"@type":"http://schema.org/Person",name:z},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:k}},provider:{"@type":"http://schema.org/Organization",name:E},pickupTime:f,pickupLocation:{"@type":"http://schema.org/Place",name:C,telephone:P,address:b},dropoffTime:$,dropoffLocation:{"@type":"http://schema.org/Place",name:D,telephone:P,address:N}})}return p}}).call();