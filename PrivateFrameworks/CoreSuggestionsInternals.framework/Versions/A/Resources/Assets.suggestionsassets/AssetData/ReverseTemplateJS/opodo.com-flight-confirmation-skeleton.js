(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);for(var n,i=a.getSpan().nextText(t.passengerNamePrefix).parentTag("table3").allInnerTags("tr3").filter(function(e){return e.tagContents().getLength()}),p=[],o=0;o<i.length;o++){i[o];for(var g=a.getSpan().nextText(t.passengerNamePrefix).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1:([A-Za-z0-9\n\s'\-\.]+)/,t.passengerNamePrefix),1).trim().split("\n"),l=0;l<g.length;l++)n=g[l].trim(),p.push(n)}for(var s=[],d=a.getSpan().nextText(t.flightDetailsHeader).nextText(t.reservationIdPrefix).parentTag("td2").tagContents().innerCapture(new RegExp(regExpEscape(t.reservationIdPrefix)+": (\\w{6})"),1),m=a.getSpan().nextText(t.passengerNamePrefix).nextTag("table3");m.allInnerTagsFiltered("td3")[0]&&m.allInnerTags("td3")[0].toString().match(t.flightCheck);){var u=m.firstTag("tr3").innerDate(),h=u.nextTag("tr3").nextTag("td3").nextTag("td3"),x=combineDateAndTime(u,h.innerDate()),T=h.innerCapture(/([A-Za-z0-9\s]+?)\([A-Z]{3}\)/,1).trim(),f=h.innerCapture(/\((\w{3})\)/,1),v=h.nextTag("tr3").nextTag("td3").nextTag("td3"),C=combineDateAndTime(u,v.innerDate());Date.parse(x)>Date.parse(C)&&(C=modifyDate(C,1));var c=v.innerCapture(/([A-Za-z0-9\s]+?)\([A-Z]{3}\)/,1).trim(),A=v.innerCapture(/\((\w{3})\)/,1),N=v.nextTag("table4").nextTag("td4").nextTag("td4").tagContents().innerCapture(/($<airlineName>.+)\(($<airlineCode>\w{2})\s+($<flightNumber>\d+)\)/),D=N.$airlineName.trim(),b=N.$airlineCode,S=N.$flightNumber;ASSERT(T,c,x,C)&&s.push({departureDate:x,arrivalDate:C,departureAirport:T,arrivalAirport:c,departureAirportCode:f,arrivalAirportCode:A,airlineName:D,airlineCode:b,flightNumber:S}),m=S.nextTag("table3")}var y=[];for(o=0;o<s.length;o++){var z=s[o];for(l=0;l<p.length;l++)y.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:z.airlineName,airlineCode:z.airlineCode,flightNumber:z.flightNumber,departureAirportFuzzy:z.departureAirport,departureTime:z.departureDate,departureAirportCode:z.departureAirportCode,arrivalAirportFuzzy:z.arrivalAirport,arrivalTime:z.arrivalDate,arrivalAirportCode:z.arrivalAirportCode},underName:{"@type":"http://schema.org/Person",name:p[l]},reservationId:d,reservationStatus:"http://schema.org/ReservationConfirmed",reservedTicket:{"@type":"http://schema.org/Ticket",ticketedSeat:{"@type":"http://schema.org/Seat"}}})}if(y.length)return y}}).call();