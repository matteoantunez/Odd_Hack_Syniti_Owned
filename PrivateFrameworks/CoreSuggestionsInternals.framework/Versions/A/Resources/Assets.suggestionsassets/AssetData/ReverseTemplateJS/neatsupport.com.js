(function(){return function(e,t,n){var a,r,i,c,o,p,s,g,l,u,m,C,d,x,S=Scanner.fromMessage(e);if(S.setLocale(t),!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;o=S.getSpan().nextRegExp(n.reservationId).nextAnyTag("td").tagContents(),a=S.getSpan().nextRegExp(n.guestName).nextAnyTag("td").tagContents(),s=S.getSpan().nextRegExp(n.checkInDate).nextDate(),g=S.getSpan().nextRegExp(n.checkOutDate).nextDate(),i=(f=S.getSpan().nextRegExp(n.price).nextAnyTag("td").tagContents()).innerCapture(/([\d,.]+)/,1),c=f.innerCapture(/([^\d,.]+)/,1).trim();var h=S.getSpan().nextRegExp(n.hotelInfo).parentAnyTag("table").parentAnyTag("table").tagContents();if(u=h.innerCapture(regExpFormatted(/(.+?)\s+\[/),1),C=h.innerAddress(),m=h.innerPhoneNumber(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(a,o,s,g,u))return CONTINUE;p="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){var f;if(o=S.getSpan().innerCapture(n.cancelReservationId,1),a=S.getSpan().innerCapture(n.cancelGuestName,1),r=S.getSpan().innerCapture(n.cancelGuestEmail,1),i=(f=S.getSpan().innerCapture(n.cancelPrice,1)).innerCapture(/([\d,.]+)/,1),c=f.innerCapture(/([^\d,.]+)/,1).trim(),s=S.getSpan().nextRegExp(n.cancelCheckInDate).nextDate(),g=S.getSpan().nextRegExp(n.cancelCheckOutDate).nextDate(),u=S.getSpan().innerCapture(n.cancelHotelName,1),C=S.getSpan().innerCapture(n.cancelHotelAddress,1).innerAddress(),!ASSERT(a,o,s,g,u))return CONTINUE;p="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:r},totalPrice:i,priceCurrency:c,checkinTime:s,checkoutTime:g,modifyReservationUrl:d,cancelReservationUrl:x,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationId:o,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:u,url:l,telephone:m,address:C}}]}}).call();