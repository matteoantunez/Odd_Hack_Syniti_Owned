(function(){return function(e,r,t){var a,i,n,m,p,o,u,s,l,d,g,h,c,v,b=Scanner.fromMessage(e);b.setLocale(r);var N=[],y={};a=(v=b.getSpan().next(t.passengers).parentAnyTag("table")).next(t.name).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.name),1),ASSERT(a)&&(y[a]={name:a,ticketNumber:v.next(t.ticketNumber).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.ticketNumber),1),totalPrice:i,priceCurrency:n,seats:{},seatingType:{},programName:m?m.$name:null,membershipNumber:m?m.$number:null}),s={},g=(d=b.getSpan().next(t.itinerary).nextDate()).nextTransitInformation().innerCapture(regExpFormatted(/($<airlineName>.*)\s+\1\s+($<flightNumber>\d*)/,t.flight)),s.airlineName=g.$airlineName,s.flightNumber=g.$flightNumber,h=(p=b.getSpan().next(t.departureTime).parentAnyTag("td").innerDate()).nextAnyTag("td").tagContents().innerCapture(/($<departureFuzzy>.*)\s+-\s+($<departureCode>.*)/),s.departureCode=h.$departureCode,s.departureAirport=h.$departureFuzzy,c=(o=b.getSpan().next(t.arrivalTime).parentAnyTag("td").innerDate()).nextAnyTag("td").tagContents().innerCapture(/($<arrivalFuzzy>.*)\s+-\s+($<arrivalCode>.*)/),s.arrivalCode=c.$arrivalCode,s.arrivalAirport=c.$arrivalFuzzy,s.departureTime=combineDateAndTime(d,p),s.arrivalTime=combineDateAndTime(d,o),ASSERT(s.flightNumber,s.departureCode,s.arrivalCode,s.departureTime,s.arrivalTime,s.airlineName)&&N.push(s);var C=[];for(u=0;u<N.length;u++){l=N[u];for(var T=Object.keys(y),A=0;A<T.length;A++){var f={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:l.airlineName,airlineCode:l.airlineCode,flightNumber:l.flightNumber,departureAirportFuzzy:l.departureAirport,departureAirportCode:l.departureCode,departureTime:l.departureTime,arrivalAirportFuzzy:l.arrivalAirport,arrivalAirportCode:l.arrivalCode,arrivalTime:l.arrivalTime},underName:{"@type":"http://schema.org/Person",name:(v=y[T[A]]).name},checkinUrl:l.checkinUrl,reservationId:l.reservationId,reservationStatus:"http://schema.org/Reservation"+(l.reservationStatus||"Confirmed"),totalPrice:v.totalPrice,priceCurrency:v.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:v.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:v.seats[l.flightNumber],seatingType:v.seatingType[l.flightNumber]}}};valid(v.membershipNumber,v.programName)&&(f.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:v.membershipNumber,programName:v.programName}),C.push(f)}}if(C.length)return C}}).call();