(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,o,p,s=a.getSpan(),g=[],l=[];if(r.isETicket.test(e.subject))n=s.nextText(r.underPersonNameETicket_prefix).nextTag("td1").nextTag("td1").tagContents();else{var u=s.nextText(r.underPersonBlock_prefix),x=u.nextText(r.underPersonFirstName_prefix).nextTag("td3").tagContents(),c=u.nextText(r.underPersonLastName_prefix).nextTag("td3").tagContents();n=x+" "+c}if(i=s.innerCapture(regExpFormatted(/\1 ([a-zA-Z0-9]+)./,r.reservationId_prefix),1),s.nextText(r.totalPrice_prefix)!==a.getNullSpan()){var d=s.nextText(r.totalPrice_prefix).nextTag("td1").nextTag("td1").nextTag("td1").nextTag("td1").tagContents();[,p,o]=/^(.*) (.*)$/.exec(d)}return g=s.nextRegExp(r.reservationForBlock_prefix).nextTag("table1").allInnerTags("tr2").filter(function(e){return e.innerDate().exists()}),s.nextText(r.isReservationChange)!==a.getNullSpan()&&delete g[0],function(t,n){t.forEach(function(t){var i,o,p,g,l,u,x,c,d,T,m;r.isETicket.test(e.subject)&&(g=s.nextText(r.ticketNumber_prefix).nextTag("td1").nextTag("td1").tagContents()),i=s.innerCapture(regExpFormatted(/\1(.*)\n(.*)\n([a-zA-Z0-9 ]+)</,r.reservationForBlock_prefix),4),l=s.innerCapture(regExpFormatted(/\1 (.*) </,r.seatType_prefix),1);var C=t.allInnerTags("td2"),f=C[5].tagContents();[,o,p]=/^([a-zA-Z]+) ([a-zA-Z0-9]+)/.exec(f),x=C[2].tagContents(),[,c]=/\((.*)\)/.exec(x),T=C[4].tagContents(),[,m]=/\((.*)\)/.exec(T),u=C[1].tagContents().toString().slice(0,-1),(u=a.getDetachedSpan(u).innerDate())===a.getNullSpan()&&(u=C[1].tagContents()),d=C[3].tagContents().toString().slice(0,-1),(d=a.getDetachedSpan(d).innerDate())===a.getNullSpan()&&(d=C[3].tagContents()),n({airlineName:i,airlineCode:o,flightNumber:p,departureDateTime:u,departureAirport:x,departureAirportCode:c,arrivalDateTime:d,arrivalAirport:T,arrivalAirportCode:m,ticketNumber:g,seatType:l})})}(g,function(e){ASSERT(e.flightNumber,e.departureAirport,e.arrivalAirport)&&l.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:n},reservationId:i,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:o,priceCurrency:p,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:e.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}}})}),l.length>=1?l:CONTINUE}}).call();