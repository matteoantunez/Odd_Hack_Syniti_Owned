(function(){return function(e,t,n){var r=Scanner.fromMessage(e);r.setLocale(t);var a,i,o,s,c,g,x,p,l,h=r.getSpan(),m=n.isCancellation?"Cancelled":"Confirmed";c=h.nextText(n.hotelNamePrefix).nextText(n.reservationIdPrefix).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s?(.+)/,n.reservationIdPrefix),1),a=h.innerCapture(n.underPersonNameRegExp,1).tagContents();var d=h.nextText(n.hotelNamePrefix).nextTag("table3").nextTag("table3").allInnerTags("td3").map(function(e){return e.tagContents()});d&&d.length>=3&&(i=d[0],s=d[3]?r.getDetachedSpan(d[2]+", "+d[3]):d[2],d[5]&&(o=d[5])),h.next(n.localeTest).exists()&&r.setLocale("en_GB"),g=h.next(n.checkInDateTimePrefix).nextDate(),x=h.next(n.checkOutDateTimePrefix).nextDate();var u=h.innerCapture(regExpFormatted(/\1\s?([\d\,\.]+)\s?(\D{1,3})/,n.pricePrefix));if(u&&u!==r.getNullSpan()&&3===u.length?(p=u[1],l=u[2]):(u=h.innerCapture(regExpFormatted(/\1\s(\D)\s?([\d\,\.]+)/,n.pricePrefix)))&&3===u.length?(p=u[1],l=u[2]):(u=h.innerCapture(regExpFormatted(/\1\s?([\d\,\.]+)\s(\D)/,n.pricePrefix)))&&3===u.length&&(p=u[1],l=u[2]),ASSERT(g,OR(i,s)))return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a},totalPrice:p,priceCurrency:l,checkinTime:g,checkoutTime:x,reservationStatus:"http://schema.org/Reservation"+m,reservationId:c,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:i,telephone:o,address:s}}]}}).call();