(function(){return function(e,t,r){var n=Scanner.fromMessage(e);n.setLocale(t);var a,i,l,d,p,o,u,g,m,s,A=n.getSpan(),c=[],C=[],T=A.next(r.dates).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<firstDate>.*)\s-\s($<secondDate>.*)/,r.dates)),h=T?T.$firstDate:null;A.next(r.itNum).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+(.*)/,r.itNum),1);i=r.cancelled.test(e.plain)?"Cancelled":"Confirmed",l=(T=A.next(r.confirmation).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+($<confirm>.*)\s*\(($<airlineName>.*)\)/,r.confirmation)))?T.airlineName:null,null===(a=T?T.$confirm:null)&&(a=A.next(r.itNum).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s*[\n]+(\d+)/,r.itNum),1));var $=A.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$1")}),f=A.next(r.ticket).parentAnyTag("td").tagContents().toString().split("\n").filter(function(e){return e.length>0}).map(function(e){return e.replace(/(\d+)\s*\((.*)\)/,"$2")});T=n.getSpan().next(r.departure).parentAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/[a-zA-Z ]+($<flightNumber>\d+)\s(?:\1.*)?/);for(var v=1;v<$.length;v++)c.push({name:f[v],ticketNumber:$[v]});$!==undefined&&0!==$.length||c.push({name:n.getSpan().next(r.traveler).nextAnyTag("td").tagContents().innerCapture(/([^\n]+)\s[\n]+/,1).trim(),ticketNumber:null});var x=A.next(r.dep).parentAnyTag("table"),b=A.next(r.ari).parentAnyTag("table"),N=function(e,t){for(var a=e.allInnerTagsFiltered("table8"),i=n.getDetachedSpan(A.next(t).parentAnyTag("table").innerDate().toString()),l=!1,c=0;c<a.length;c+=2){var T=A.next(t).parentAnyTag("table").allInnerTagsFiltered("table8")[c].innerCapture(/($<dep>[a-zA-Z ]+)\s\(($<depCode>\w+)\)\s[\n]+\s*\[.*\]\s($<time>\d?\d:\d\d(?:am|pm)?)($<day>\s\+\d\s\w+)?/i);o=T?T.$dep:null,p=T?T.$time:null,u=T?T.$depCode:null,p=combineDateAndTime(i,p);var h=A.next(t).parentAnyTag("table").allInnerTagsFiltered("table8")[c+1].innerCapture(/($<dep>[a-zA-Z ]+)\s\(($<depCode>\w+)\)\s[\n]+\s*\[.*\]\s($<time>\d?\d:\d\d(?:am|pm)?)($<day>\s\+\d\s\w+)?/i);m=h?h.$dep:null,g=h?h.$time:null,s=h?h.$depCode:null,(h?h.$day:null).isNullSpan_?g=combineDateAndTime(i,g):(i=modifyDate(i,1),g=combineDateAndTime(i,g)),c>1&&(l=!0);var $=(l?A.next(o).next(o).next(o):A.next(o)).parentAnyTag("td").previousTag("td6").tagContents().innerCapture(regExpFormatted(/[a-zA-Z ]+($<flightNumber>\d+)\s?(?:\1.*)?/,r.op));d=$?$.$flightNumber:null,ASSERT(o,p,m,g)&&C.push({departureAirport:o,departureCode:u,departureTime:p,arrivalTime:g,arrivalAirport:m,flightNumber:d,arrivalCode:s})}};if(N(x,r.dep),N(b,r.ari),0===C.length)for(var y=A.next(r.departure).nextTag("table7"),S=A.next(r.departure).nextTag("table7").allInnerTagsFiltered("td8");!y.isNullSpan_&&0!==S.length;){T=S[0].innerCapture(/($<airlineName>[a-zA-Z\s]+)\s\(($<airlineCode>[\d\w]+)\)/),o=T?T.$airlineName:null,u=T?T.$airlineCode:null,p=S[1];var F=y.previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/[a-zA-Z ]+($<flightNumber>\d+)\s?(?:\1.*)?/,r.op));d=F?F.$flightNumber:null,p=combineDateAndTime(n.getDetachedSpan(h.toString()),p),T=S[2].innerCapture(/($<airlineName>[a-zA-Z]+)\s\(($<airlineCode>[\d\w]+)\)/),m=T?T.$airlineName:null,s=T?T.$airlineCode:null,/\d?\d:\d{2}(?:AM|PM)?/i.test(g=S[3])||(g=S[4]),g=combineDateAndTime(n.getDetachedSpan(h.toString()),g),ASSERT(o,p,m,g)&&C.push({departureAirport:o,departureCode:u,departureTime:p,arrivalTime:g,arrivalAirport:m,flightNumber:d,arrivalCode:s}),S=(y=y.nextTag("table7")).allInnerTagsFiltered("td8")}for(var z=[],D=0;D<C.length;D++)for(var E=C[D],Z=0;Z<c.length;Z++){z.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:l,flightNumber:E.flightNumber,departureAirportFuzzy:E.departureAirport,departureAirportCode:E.departureCode,departureTime:E.departureTime,arrivalAirportFuzzy:E.arrivalAirport,arrivalAirportCode:E.arrivalCode,arrivalTime:E.arrivalTime},underName:{"@type":"http://schema.org/Person",name:c[Z].name},reservationId:a,ticketNumber:c[Z].ticketNumber,reservationStatus:"http://schema.org/Reservation"+i})}return z}}).call();